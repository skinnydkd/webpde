<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Economia - Guia Universit√†ria Completa</title>
    <meta name="description" content="Apr√®n economia amb simuladors interactius: microeconomia, macroeconomia, estructures de mercat, teoria de jocs, IS-LM, AD-AS i molt m√©s.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.1.16/umd/Recharts.js"></script>
    <style>
        * { scrollbar-width: thin; scrollbar-color: #e91e63 #fdf6e3; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #fdf6e3; }
        ::-webkit-scrollbar-thumb { background-color: #e91e63; border-radius: 3px; }
        input[type="range"] { -webkit-appearance: none; height: 8px; border-radius: 4px; background: #fce4ec; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: #e91e63; cursor: pointer; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.3s ease-out; }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 via-white to-pink-50">
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useMemo, useCallback } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area, ReferenceLine, Legend, BarChart, Bar, ComposedChart, Scatter, PieChart, Pie, Cell } = Recharts;
        
        // Icons
        const Icon = ({ name, size = 24 }) => {
            const icons = { TrendingUp: "üìà", TrendingDown: "üìâ", BookOpen: "üìñ", Users: "üë•", Building2: "üè¢", Globe: "üåç", Lightbulb: "üí°", Calculator: "üßÆ", BarChart3: "üìä", Scale: "‚öñÔ∏è", Landmark: "üèõÔ∏è", Banknote: "üíµ", ShoppingCart: "üõí", Factory: "üè≠", GraduationCap: "üéì", Brain: "üß†", Target: "üéØ", ChevronDown: "‚ñº", ChevronUp: "‚ñ≤", ChevronRight: "‚ñ∂", Check: "‚úì", X: "‚úï", Menu: "‚ò∞", Clock: "üïê", Award: "üèÜ", Home: "üè†", Briefcase: "üíº", Gamepad2: "üéÆ", AlertTriangle: "‚ö†Ô∏è", Crown: "üëë", Swords: "‚öîÔ∏è", Store: "üè™", Coins: "ü™ô", Truck: "üöö" };
            return <span style={{fontSize: size * 0.75}}>{icons[name] || "‚Ä¢"}</span>;
        };

function EconomiaApp() {
    const [section, setSection] = useState('inicio');
    const [menuOpen, setMenuOpen] = useState(false);
    const [idioma, setIdioma] = useState('val');

    // Reusable components
    const Card = ({ children, className = "", title, icon }) => (
        <div className={`bg-white rounded-2xl shadow-sm border border-gray-100 p-6 ${className} animate-fade`}>
            {title && <div className="flex items-center gap-2 mb-4"><span className="text-pink-500">{icon}</span><h3 className="font-bold text-gray-800">{title}</h3></div>}
            {children}
        </div>
    );
    
    const Slider = ({ label, value, onChange, min, max, step = 1, suffix = "" }) => (
        <div className="space-y-1">
            <div className="flex justify-between text-sm">
                <span className="text-gray-600">{label}</span>
                <span className="font-bold text-pink-600">{typeof value === 'number' ? (step < 1 ? value.toFixed(2) : value) : value}{suffix}</span>
            </div>
            <input type="range" min={min} max={max} step={step} value={value} onChange={e => onChange(Number(e.target.value))} className="w-full" />
        </div>
    );
    
    const Tabs = ({ tabs, active, onChange }) => (
        <div className="flex flex-wrap gap-1 bg-gray-100 p-1 rounded-xl mb-4">
            {tabs.map(tab => (
                <button key={tab.id} onClick={() => onChange(tab.id)} className={`flex-1 min-w-fit py-2 px-3 rounded-lg text-sm font-medium transition-all ${active === tab.id ? 'bg-white shadow text-pink-600' : 'text-gray-600 hover:text-gray-800'}`}>
                    {tab.label}
                </button>
            ))}
        </div>
    );
    
    const FormulaBox = ({ formula, desc }) => (
        <div className="bg-amber-50 border border-amber-200 rounded-xl p-3 my-3">
            <p className="text-center text-lg font-mono text-amber-800">{formula}</p>
            {desc && <p className="text-center text-sm text-amber-600 mt-1">{desc}</p>}
        </div>
    );
    
    const ConceptBox = ({ title, children, color = "pink" }) => {
        const colors = { pink: "border-pink-400 bg-pink-50", blue: "border-blue-400 bg-blue-50", green: "border-green-400 bg-green-50", amber: "border-amber-400 bg-amber-50", violet: "border-violet-400 bg-violet-50", red: "border-red-400 bg-red-50", cyan: "border-cyan-400 bg-cyan-50" };
        return (
            <div className={`border-l-4 ${colors[color]} p-4 rounded-r-xl my-3`}>
                {title && <h4 className="font-bold text-gray-800 mb-2">{title}</h4>}
                <div className="text-gray-700 text-sm">{children}</div>
            </div>
        );
    };
    
    const ResultCard = ({ title, value, color = "gray" }) => (
        <div className={`p-3 bg-${color}-50 border border-${color}-200 rounded-xl text-center`}>
            <p className={`text-xs text-${color}-600 mb-1`}>{title}</p>
            <p className={`text-xl font-black text-${color}-700`}>{value}</p>
        </div>
    );

    const NavBtn = ({ sec, icon, label }) => (
        <button onClick={() => { setSection(sec); setMenuOpen(false); }} className={`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-all ${section === sec ? 'bg-pink-100 text-pink-700' : 'text-gray-600 hover:bg-gray-100'}`}>
            <Icon name={icon} size={16} /><span className="hidden xl:inline">{label}</span>
        </button>
    );

    // ========================================================================
    // SECTION: INICIO
    // ========================================================================
    const Inicio = () => {
        const txt = {
            val: { title: "Economia", subtitle: "Guia Universit√†ria Completa", desc: "Des dels fonaments fins als models avan√ßats" },
            es: { title: "Econom√≠a", subtitle: "Gu√≠a Universitaria Completa", desc: "Desde los fundamentos hasta los modelos avanzados" },
            en: { title: "Economics", subtitle: "Complete University Guide", desc: "From fundamentals to advanced models" }
        }[idioma];
        
        const sections = [
            { id: 'consumidor', name: idioma === 'val' ? 'Teoria Consumidor' : idioma === 'es' ? 'Teor√≠a Consumidor' : 'Consumer Theory', icon: 'üë•', color: 'from-pink-500 to-rose-500', desc: idioma === 'val' ? 'Utilitat, prefer√®ncies, corbes indifer√®ncia' : idioma === 'es' ? 'Utilidad, preferencias, curvas indiferencia' : 'Utility, preferences, indifference curves' },
            { id: 'ofertaDemanda', name: idioma === 'val' ? 'Oferta i Demanda' : idioma === 'es' ? 'Oferta y Demanda' : 'Supply & Demand', icon: 'üìä', color: 'from-blue-500 to-cyan-500', desc: idioma === 'val' ? 'Equilibri, elasticitat, excedents' : idioma === 'es' ? 'Equilibrio, elasticidad, excedentes' : 'Equilibrium, elasticity, surplus' },
            { id: 'costos', name: idioma === 'val' ? 'Costos Producci√≥' : idioma === 'es' ? 'Costes Producci√≥n' : 'Production Costs', icon: 'üè≠', color: 'from-amber-500 to-orange-500', desc: idioma === 'val' ? 'CF, CV, CMe, CMg, economies escala' : idioma === 'es' ? 'CF, CV, CMe, CMg, econom√≠as escala' : 'FC, VC, AC, MC, economies of scale' },
            { id: 'mercats', name: idioma === 'val' ? 'Estructures Mercat' : idioma === 'es' ? 'Estructuras Mercado' : 'Market Structures', icon: 'üè¢', color: 'from-violet-500 to-purple-500', desc: idioma === 'val' ? 'CP, Monopoli, Oligopoli (Cournot, Stackelberg)' : idioma === 'es' ? 'CP, Monopolio, Oligopolio (Cournot, Stackelberg)' : 'PC, Monopoly, Oligopoly (Cournot, Stackelberg)' },
            { id: 'fallades', name: idioma === 'val' ? 'Fallades Mercat' : idioma === 'es' ? 'Fallos Mercado' : 'Market Failures', icon: '‚ö†Ô∏è', color: 'from-red-500 to-rose-500', desc: idioma === 'val' ? 'Externalitats, b√©ns p√∫blics, asimetria' : idioma === 'es' ? 'Externalidades, bienes p√∫blicos, asimetr√≠a' : 'Externalities, public goods, asymmetry' },
            { id: 'macro', name: 'Macroeconomia', icon: 'üåç', color: 'from-emerald-500 to-teal-500', desc: idioma === 'val' ? 'PIB, IS-LM, AD-AS, inflaci√≥, atur' : idioma === 'es' ? 'PIB, IS-LM, AD-AS, inflaci√≥n, desempleo' : 'GDP, IS-LM, AD-AS, inflation, unemployment' },
            { id: 'monetaria', name: idioma === 'val' ? 'Economia Monet√†ria' : idioma === 'es' ? 'Econom√≠a Monetaria' : 'Monetary Economics', icon: 'üèõÔ∏è', color: 'from-indigo-500 to-blue-500', desc: idioma === 'val' ? 'Banc Central, pol√≠tica monet√†ria' : idioma === 'es' ? 'Banco Central, pol√≠tica monetaria' : 'Central Bank, monetary policy' },
            { id: 'comerc', name: idioma === 'val' ? 'Comer√ß Internacional' : idioma === 'es' ? 'Comercio Internacional' : 'International Trade', icon: 'üöö', color: 'from-cyan-500 to-teal-500', desc: idioma === 'val' ? 'Avantatge comparatiu, aranzels' : idioma === 'es' ? 'Ventaja comparativa, aranceles' : 'Comparative advantage, tariffs' },
            { id: 'jocs', name: idioma === 'val' ? 'Teoria de Jocs' : idioma === 'es' ? 'Teor√≠a de Juegos' : 'Game Theory', icon: 'üéÆ', color: 'from-fuchsia-500 to-pink-500', desc: idioma === 'val' ? 'Nash, dilema presoner' : idioma === 'es' ? 'Nash, dilema prisionero' : 'Nash, prisoner dilemma' },
            { id: 'historia', name: idioma === 'val' ? 'Hist√≤ria Econ√≤mica' : idioma === 'es' ? 'Historia Econ√≥mica' : 'Economic History', icon: 'üïê', color: 'from-gray-500 to-slate-500', desc: idioma === 'val' ? 'Smith, Keynes, Friedman' : 'Smith, Keynes, Friedman' },
        ];
        
        return (
            <div className="space-y-8">
                <div className="text-center py-8">
                    <div className="inline-flex items-center gap-2 px-4 py-2 bg-pink-100 rounded-full text-pink-600 text-sm font-medium mb-4">
                        üéì {idioma === 'val' ? 'Batxillerat ¬∑ FP ¬∑ Universitat' : idioma === 'es' ? 'Bachillerato ¬∑ FP ¬∑ Universidad' : 'High School ¬∑ Vocational ¬∑ University'}
                    </div>
                    <h1 className="text-4xl md:text-5xl font-black text-gray-800 mb-4">{txt.title}</h1>
                    <p className="text-xl text-gray-500 mb-2">{txt.subtitle}</p>
                    <p className="text-gray-400">{txt.desc}</p>
                </div>
                
                <div className="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    {sections.map(sec => (
                        <button key={sec.id} onClick={() => setSection(sec.id)} className="group text-left bg-white rounded-2xl border border-gray-100 overflow-hidden hover:shadow-lg transition-all">
                            <div className={`p-4 bg-gradient-to-r ${sec.color} text-white text-2xl`}>{sec.icon}</div>
                            <div className="p-4">
                                <h3 className="font-bold text-gray-800 group-hover:text-pink-600">{sec.name}</h3>
                                <p className="text-sm text-gray-500 mt-1">{sec.desc}</p>
                            </div>
                        </button>
                    ))}
                </div>
                
                <Card title={idioma === 'val' ? "Qu√® √©s l'Economia?" : idioma === 'es' ? "¬øQu√© es la Econom√≠a?" : "What is Economics?"} icon="üìñ">
                    <div className="grid md:grid-cols-2 gap-6">
                        <div>
                            <p className="text-gray-700 mb-4">
                                {idioma === 'val' ? "L'economia estudia com les societats administren recursos escassos per satisfer necessitats il¬∑limitades." : idioma === 'es' ? "La econom√≠a estudia c√≥mo las sociedades administran recursos escasos para satisfacer necesidades ilimitadas." : "Economics studies how societies manage scarce resources to satisfy unlimited needs."}
                            </p>
                            <ConceptBox title={idioma === 'val' ? "Escassetat" : idioma === 'es' ? "Escasez" : "Scarcity"} color="pink">
                                {idioma === 'val' ? "Recursos limitats, desitjos infinits. Aix√≤ ens obliga a triar." : idioma === 'es' ? "Recursos limitados, deseos infinitos. Esto nos obliga a elegir." : "Limited resources, infinite wants. This forces us to choose."}
                            </ConceptBox>
                            <ConceptBox title={idioma === 'val' ? "Cost d'Oportunitat" : idioma === 'es' ? "Coste de Oportunidad" : "Opportunity Cost"} color="blue">
                                {idioma === 'val' ? "El valor de la millor alternativa sacrificada." : idioma === 'es' ? "El valor de la mejor alternativa sacrificada." : "The value of the best alternative foregone."}
                            </ConceptBox>
                        </div>
                        <div className="grid grid-cols-2 gap-3">
                            <div className="bg-pink-50 p-4 rounded-xl text-center">
                                <p className="text-3xl mb-2">üë•</p>
                                <p className="font-bold text-pink-700">Micro</p>
                                <p className="text-xs text-pink-600">{idioma === 'val' ? 'Individus i empreses' : idioma === 'es' ? 'Individuos y empresas' : 'Individuals & firms'}</p>
                            </div>
                            <div className="bg-blue-50 p-4 rounded-xl text-center">
                                <p className="text-3xl mb-2">üåç</p>
                                <p className="font-bold text-blue-700">Macro</p>
                                <p className="text-xs text-blue-600">{idioma === 'val' ? 'Economia agregada' : idioma === 'es' ? 'Econom√≠a agregada' : 'Aggregate economy'}</p>
                            </div>
                        </div>
                    </div>
                </Card>
            </div>
        );
    };

    // ========================================================================
    // SECTION: TEORIA DEL CONSUMIDOR
    // ========================================================================
    const TeoriaConsumidor = () => {
        const [tab, setTab] = useState('utilitat');
        const [q1, setQ1] = useState(5);
        const [q2, setQ2] = useState(5);
        const [p1, setP1] = useState(10);
        const [p2, setP2] = useState(20);
        const [renda, setRenda] = useState(200);
        const [alpha, setAlpha] = useState(0.5);
        
        const utilitat = useMemo(() => Math.pow(q1, alpha) * Math.pow(q2, 1 - alpha), [q1, q2, alpha]);
        
        const optim = useMemo(() => {
            const q1Opt = (alpha * renda) / p1;
            const q2Opt = ((1 - alpha) * renda) / p2;
            return { q1: q1Opt.toFixed(2), q2: q2Opt.toFixed(2), u: (Math.pow(q1Opt, alpha) * Math.pow(q2Opt, 1 - alpha)).toFixed(2) };
        }, [alpha, renda, p1, p2]);
        
        const txt = { val: { title: 'Teoria del Consumidor', utilitat: 'Utilitat', pref: 'Prefer√®ncies', optim: 'Elecci√≥ √íptima', efectes: 'Efectes Renda/Substituci√≥' }, es: { title: 'Teor√≠a del Consumidor', utilitat: 'Utilidad', pref: 'Preferencias', optim: 'Elecci√≥n √ìptima', efectes: 'Efectos Renta/Sustituci√≥n' }, en: { title: 'Consumer Theory', utilitat: 'Utility', pref: 'Preferences', optim: 'Optimal Choice', efectes: 'Income/Substitution Effects' } }[idioma];
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{txt.title}</h1></div>
                
                <Tabs tabs={[
                    { id: 'utilitat', label: 'üìä ' + txt.utilitat },
                    { id: 'optim', label: 'üéØ ' + txt.optim },
                    { id: 'efectes', label: 'üîÑ ' + txt.efectes },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'utilitat' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìö Teoria: Utilitat" : idioma === 'es' ? "üìö Teor√≠a: Utilidad" : "üìö Theory: Utility"} icon="üìñ">
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <p className="text-gray-700 mb-4">{idioma === 'val' ? "La utilitat mesura la satisfacci√≥ del consum. √âs ordinal (ordena prefer√®ncies)." : idioma === 'es' ? "La utilidad mide la satisfacci√≥n del consumo. Es ordinal (ordena preferencias)." : "Utility measures consumption satisfaction. It's ordinal (ranks preferences)."}</p>
                                    <ConceptBox title={idioma === 'val' ? "Utilitat Marginal (UMg)" : idioma === 'es' ? "Utilidad Marginal (UMg)" : "Marginal Utility (MU)"} color="pink">
                                        <FormulaBox formula="UMg = ‚àÇU/‚àÇQ" />
                                        {idioma === 'val' ? "Generalment DECREIXENT (llei de la utilitat marginal decreixent)." : idioma === 'es' ? "Generalmente DECRECIENTE (ley de la utilidad marginal decreciente)." : "Generally DECREASING (law of diminishing marginal utility)."}
                                    </ConceptBox>
                                    <ConceptBox title="Cobb-Douglas" color="violet">
                                        <FormulaBox formula="U = Q‚ÇÅ·µÖ ¬∑ Q‚ÇÇ‚ÅΩ¬π‚Åª·µÖ‚Åæ" />
                                    </ConceptBox>
                                </div>
                                <div className="space-y-4">
                                    <Slider label="Q‚ÇÅ" value={q1} onChange={setQ1} min={1} max={20} />
                                    <Slider label="Q‚ÇÇ" value={q2} onChange={setQ2} min={1} max={20} />
                                    <Slider label="Œ±" value={alpha} onChange={setAlpha} min={0.1} max={0.9} step={0.05} />
                                    <div className="p-6 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl text-white text-center">
                                        <p className="text-white/70">{idioma === 'val' ? 'Utilitat Total' : idioma === 'es' ? 'Utilidad Total' : 'Total Utility'}</p>
                                        <p className="text-4xl font-black">{utilitat.toFixed(2)}</p>
                                    </div>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'optim' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üéØ Elecci√≥ √íptima" : idioma === 'es' ? "üéØ Elecci√≥n √ìptima" : "üéØ Optimal Choice"} icon="üéØ">
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <ConceptBox title={idioma === 'val' ? "Restricci√≥ Pressupost√†ria" : idioma === 'es' ? "Restricci√≥n Presupuestaria" : "Budget Constraint"} color="blue">
                                        <FormulaBox formula="P‚ÇÅ¬∑Q‚ÇÅ + P‚ÇÇ¬∑Q‚ÇÇ ‚â§ R" />
                                    </ConceptBox>
                                    <ConceptBox title={idioma === 'val' ? "Condici√≥ d'√íptim" : idioma === 'es' ? "Condici√≥n de √ìptimo" : "Optimality Condition"} color="green">
                                        <FormulaBox formula="RMS = P‚ÇÅ/P‚ÇÇ" desc={idioma === 'val' ? "Relaci√≥ Marginal Substituci√≥ = Relaci√≥ Preus" : idioma === 'es' ? "Relaci√≥n Marginal Sustituci√≥n = Relaci√≥n Precios" : "Marginal Rate Substitution = Price Ratio"} />
                                    </ConceptBox>
                                </div>
                                <div className="space-y-3">
                                    <Slider label={idioma === 'val' ? "Renda (R)" : "Income (R)"} value={renda} onChange={setRenda} min={50} max={500} step={10} suffix="‚Ç¨" />
                                    <Slider label="P‚ÇÅ" value={p1} onChange={setP1} min={1} max={50} suffix="‚Ç¨" />
                                    <Slider label="P‚ÇÇ" value={p2} onChange={setP2} min={1} max={50} suffix="‚Ç¨" />
                                    <Slider label="Œ±" value={alpha} onChange={setAlpha} min={0.1} max={0.9} step={0.05} />
                                </div>
                            </div>
                        </Card>
                        <div className="grid grid-cols-3 gap-4">
                            <ResultCard title={idioma === 'val' ? "Q‚ÇÅ √íptim" : "Q‚ÇÅ √ìptimo"} value={optim.q1} color="pink" />
                            <ResultCard title={idioma === 'val' ? "Q‚ÇÇ √íptim" : "Q‚ÇÇ √ìptimo"} value={optim.q2} color="blue" />
                            <ResultCard title={idioma === 'val' ? "Utilitat Max" : "Max Utility"} value={optim.u} color="green" />
                        </div>
                    </div>
                )}
                
                {tab === 'efectes' && (
                    <Card title={idioma === 'val' ? "üîÑ Efectes Renda i Substituci√≥" : idioma === 'es' ? "üîÑ Efectos Renta y Sustituci√≥n" : "üîÑ Income and Substitution Effects"} icon="üîÑ">
                        <div className="grid md:grid-cols-2 gap-6">
                            <ConceptBox title={idioma === 'val' ? "Efecte Substituci√≥" : idioma === 'es' ? "Efecto Sustituci√≥n" : "Substitution Effect"} color="pink">
                                <p>{idioma === 'val' ? "Canvi degut al preu RELATIU (utilitat constant). SEMPRE negatiu." : idioma === 'es' ? "Cambio debido al precio RELATIVO (utilidad constante). SIEMPRE negativo." : "Change due to RELATIVE price (constant utility). ALWAYS negative."}</p>
                            </ConceptBox>
                            <ConceptBox title={idioma === 'val' ? "Efecte Renda" : idioma === 'es' ? "Efecto Renta" : "Income Effect"} color="blue">
                                <p>{idioma === 'val' ? "Canvi degut al PODER ADQUISITIU. Pot ser + o - segons el tipus de b√©." : idioma === 'es' ? "Cambio debido al PODER ADQUISITIVO. Puede ser + o - seg√∫n el tipo de bien." : "Change due to PURCHASING POWER. Can be + or - depending on good type."}</p>
                            </ConceptBox>
                        </div>
                        <div className="mt-4 overflow-x-auto">
                            <table className="w-full text-sm">
                                <thead><tr className="bg-gray-100"><th className="p-3 text-left">{idioma === 'val' ? 'Tipus B√©' : 'Good Type'}</th><th className="p-3">Ef. Subst.</th><th className="p-3">Ef. Renda</th><th className="p-3">Total</th><th className="p-3">{idioma === 'val' ? 'Exemple' : 'Example'}</th></tr></thead>
                                <tbody>
                                    <tr className="border-b"><td className="p-3 font-bold text-green-600">Normal</td><td className="p-3 text-center">(-)</td><td className="p-3 text-center">(-)</td><td className="p-3 text-center font-bold">(-)</td><td className="p-3">{idioma === 'val' ? 'Roba, restaurants' : 'Clothing, restaurants'}</td></tr>
                                    <tr className="border-b"><td className="p-3 font-bold text-amber-600">Inferior</td><td className="p-3 text-center">(-)</td><td className="p-3 text-center">(+)</td><td className="p-3 text-center font-bold">(-)</td><td className="p-3">{idioma === 'val' ? 'Transport p√∫blic' : 'Public transport'}</td></tr>
                                    <tr><td className="p-3 font-bold text-red-600">Giffen</td><td className="p-3 text-center">(-)</td><td className="p-3 text-center">(++) fort</td><td className="p-3 text-center font-bold">(+)</td><td className="p-3">{idioma === 'val' ? 'Pa en fams (rar)' : 'Bread in famine (rare)'}</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: OFERTA I DEMANDA
    // ========================================================================
    const OfertaDemanda = () => {
        const [tab, setTab] = useState('equilibri');
        const [demandaA, setDemandaA] = useState(100);
        const [demandaB, setDemandaB] = useState(2);
        const [ofertaC, setOfertaC] = useState(10);
        const [ofertaD, setOfertaD] = useState(1.5);
        const [elastP1, setElastP1] = useState(10);
        const [elastP2, setElastP2] = useState(12);
        const [elastQ1, setElastQ1] = useState(100);
        const [elastQ2, setElastQ2] = useState(80);
        
        const equilibri = useMemo(() => {
            const pEq = (demandaA - ofertaC) / (demandaB + ofertaD);
            const qEq = demandaA - demandaB * pEq;
            const excCons = 0.5 * qEq * ((demandaA/demandaB) - pEq);
            const excProd = 0.5 * qEq * (pEq - (ofertaC/ofertaD > 0 ? ofertaC/ofertaD : 0));
            return { p: Math.max(0, pEq).toFixed(2), q: Math.max(0, qEq).toFixed(2), excCons: Math.max(0, excCons).toFixed(0), excProd: Math.max(0, excProd).toFixed(0) };
        }, [demandaA, demandaB, ofertaC, ofertaD]);
        
        const elasticitat = useMemo(() => {
            const deltaQ = elastQ2 - elastQ1, deltaP = elastP2 - elastP1;
            const avgQ = (elastQ1 + elastQ2) / 2, avgP = (elastP1 + elastP2) / 2;
            const e = (deltaQ / avgQ) / (deltaP / avgP);
            const absE = Math.abs(e);
            let tipus = absE > 1 ? (idioma === 'val' ? 'El√†stica' : 'Elastic') : absE < 1 ? (idioma === 'val' ? 'Inel√†stica' : 'Inelastic') : (idioma === 'val' ? 'Unit√†ria' : 'Unitary');
            return { valor: e.toFixed(2), tipus, absE: absE.toFixed(2) };
        }, [elastP1, elastP2, elastQ1, elastQ2, idioma]);
        
        const dadesOD = useMemo(() => {
            const dades = [];
            for (let q = 0; q <= 100; q += 5) {
                const pD = Math.max(0, (demandaA - q) / demandaB);
                const pS = q >= ofertaC ? Math.max(0, (q - ofertaC) / ofertaD) : null;
                dades.push({ q, demanda: pD, oferta: pS });
            }
            return dades;
        }, [demandaA, demandaB, ofertaC, ofertaD]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Oferta i Demanda' : idioma === 'es' ? 'Oferta y Demanda' : 'Supply and Demand'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'equilibri', label: '‚öñÔ∏è ' + (idioma === 'val' ? 'Equilibri' : 'Equilibrium') },
                    { id: 'elasticitat', label: 'üìè ' + (idioma === 'val' ? 'Elasticitat' : 'Elasticity') },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'equilibri' && (
                    <div className="space-y-6">
                        <div className="grid lg:grid-cols-2 gap-6">
                            <Card title={idioma === 'val' ? "‚öôÔ∏è Simulador" : "‚öôÔ∏è Simulator"} icon="‚öôÔ∏è">
                                <div className="space-y-3">
                                    <div className="p-3 bg-pink-50 rounded-lg">
                                        <p className="text-xs font-bold text-pink-600 mb-2">{idioma === 'val' ? 'DEMANDA: Qd = a - bP' : 'DEMAND: Qd = a - bP'}</p>
                                        <Slider label="a" value={demandaA} onChange={setDemandaA} min={50} max={150} />
                                        <Slider label="b" value={demandaB} onChange={setDemandaB} min={0.5} max={5} step={0.1} />
                                    </div>
                                    <div className="p-3 bg-blue-50 rounded-lg">
                                        <p className="text-xs font-bold text-blue-600 mb-2">{idioma === 'val' ? 'OFERTA: Qs = c + dP' : 'SUPPLY: Qs = c + dP'}</p>
                                        <Slider label="c" value={ofertaC} onChange={setOfertaC} min={0} max={50} />
                                        <Slider label="d" value={ofertaD} onChange={setOfertaD} min={0.5} max={5} step={0.1} />
                                    </div>
                                </div>
                            </Card>
                            <Card>
                                <div className="h-64">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <LineChart data={dadesOD}>
                                            <CartesianGrid strokeDasharray="3 3" stroke="#f0f0f0" />
                                            <XAxis dataKey="q" label={{ value: 'Q', position: 'bottom' }} />
                                            <YAxis domain={[0, 60]} />
                                            <Tooltip />
                                            <Legend />
                                            <Line type="monotone" dataKey="demanda" stroke="#ec4899" strokeWidth={3} dot={false} name={idioma === 'val' ? "Demanda" : "Demand"} />
                                            <Line type="monotone" dataKey="oferta" stroke="#3b82f6" strokeWidth={3} dot={false} name={idioma === 'val' ? "Oferta" : "Supply"} />
                                            <ReferenceLine x={Number(equilibri.q)} stroke="#10b981" strokeDasharray="5 5" />
                                            <ReferenceLine y={Number(equilibri.p)} stroke="#10b981" strokeDasharray="5 5" />
                                        </LineChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                        </div>
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                            <ResultCard title={idioma === 'val' ? "Preu Eq." : "Eq. Price"} value={equilibri.p + "‚Ç¨"} color="green" />
                            <ResultCard title={idioma === 'val' ? "Quantitat Eq." : "Eq. Quantity"} value={equilibri.q} color="green" />
                            <ResultCard title={idioma === 'val' ? "Exc. Consumidor" : "Consumer Surplus"} value={equilibri.excCons + "‚Ç¨"} color="pink" />
                            <ResultCard title={idioma === 'val' ? "Exc. Productor" : "Producer Surplus"} value={equilibri.excProd + "‚Ç¨"} color="blue" />
                        </div>
                    </div>
                )}
                
                {tab === 'elasticitat' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìè Elasticitat Preu-Demanda" : "üìè Price Elasticity of Demand"} icon="üìè">
                            <div className="grid md:grid-cols-3 gap-4 mb-4">
                                <ConceptBox title={idioma === 'val' ? "EPD" : "PED"} color="pink">
                                    <FormulaBox formula="EPD = %ŒîQ / %ŒîP" />
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Elast. Renda" : "Income Elast."} color="blue">
                                    <FormulaBox formula="ER = %ŒîQ / %ŒîR" />
                                    <p className="text-xs">{">0: Normal, <0: Inferior"}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Elast. Creuada" : "Cross Elast."} color="green">
                                    <FormulaBox formula="EC = %ŒîQx / %ŒîPy" />
                                    <p className="text-xs">{">0: Substituts, <0: Complements"}</p>
                                </ConceptBox>
                            </div>
                        </Card>
                        <div className="grid lg:grid-cols-2 gap-6">
                            <Card title={idioma === 'val' ? "üßÆ Calculadora" : "üßÆ Calculator"} icon="üßÆ">
                                <div className="grid grid-cols-2 gap-3">
                                    <Slider label="P‚ÇÅ" value={elastP1} onChange={setElastP1} min={1} max={50} suffix="‚Ç¨" />
                                    <Slider label="P‚ÇÇ" value={elastP2} onChange={setElastP2} min={1} max={50} suffix="‚Ç¨" />
                                    <Slider label="Q‚ÇÅ" value={elastQ1} onChange={setElastQ1} min={10} max={200} />
                                    <Slider label="Q‚ÇÇ" value={elastQ2} onChange={setElastQ2} min={10} max={200} />
                                </div>
                            </Card>
                            <Card className={`${Math.abs(Number(elasticitat.absE)) > 1 ? 'bg-pink-50' : 'bg-blue-50'}`}>
                                <div className="text-center">
                                    <p className="text-sm text-gray-500 mb-2">EPD</p>
                                    <p className="text-5xl font-black text-gray-800">{elasticitat.valor}</p>
                                    <p className={`text-lg font-bold mt-2 ${Math.abs(Number(elasticitat.absE)) > 1 ? 'text-pink-600' : 'text-blue-600'}`}>{elasticitat.tipus}</p>
                                    <p className="text-sm text-gray-500 mt-2">{Math.abs(Number(elasticitat.absE)) > 1 ? (idioma === 'val' ? 'Baixar preus ‚Üë IT' : 'Lower prices ‚Üë TR') : (idioma === 'val' ? 'Pujar preus ‚Üë IT' : 'Raise prices ‚Üë TR')}</p>
                                </div>
                            </Card>
                        </div>
                    </div>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: COSTOS DE PRODUCCI√ì
    // ========================================================================
    const CostosProducio = () => {
        const [costFix, setCostFix] = useState(1000);
        const [costVarA, setCostVarA] = useState(10);
        const [costVarB, setCostVarB] = useState(0.05);
        const [quantitat, setQuantitat] = useState(100);
        
        const costos = useMemo(() => {
            const CV = costVarA * quantitat + costVarB * quantitat * quantitat;
            const CT = costFix + CV;
            const CMe = CT / quantitat;
            const CVMe = CV / quantitat;
            const CFMe = costFix / quantitat;
            const CMg = costVarA + 2 * costVarB * quantitat;
            return { CV: CV.toFixed(0), CT: CT.toFixed(0), CMe: CMe.toFixed(2), CVMe: CVMe.toFixed(2), CFMe: CFMe.toFixed(2), CMg: CMg.toFixed(2) };
        }, [costFix, costVarA, costVarB, quantitat]);
        
        const dadesCostos = useMemo(() => {
            const d = [];
            for (let q = 10; q <= 250; q += 10) {
                const CV = costVarA * q + costVarB * q * q;
                const CT = costFix + CV;
                d.push({ q, CMe: CT/q, CVMe: CV/q, CMg: costVarA + 2*costVarB*q });
            }
            return d;
        }, [costFix, costVarA, costVarB]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Costos de Producci√≥' : idioma === 'es' ? 'Costes de Producci√≥n' : 'Production Costs'}</h1></div>
                
                <Card title={idioma === 'val' ? "üìö Teoria" : "üìö Theory"} icon="üìñ">
                    <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <ConceptBox title="CF" color="blue">
                            {idioma === 'val' ? 'No varia amb Q: lloguer, amortitzaci√≥' : 'Doesnt vary with Q: rent, depreciation'}
                        </ConceptBox>
                        <ConceptBox title="CV" color="pink">
                            {idioma === 'val' ? 'Varia amb Q: mat√®ries, energia' : 'Varies with Q: materials, energy'}
                        </ConceptBox>
                        <ConceptBox title="CMe = CT/Q" color="amber">
                            {idioma === 'val' ? 'Cost per unitat. Forma U.' : 'Cost per unit. U-shaped.'}
                        </ConceptBox>
                        <ConceptBox title="CMg = dCT/dQ" color="violet">
                            {idioma === 'val' ? 'Cost unitat addicional. Clau decisions.' : 'Additional unit cost. Key for decisions.'}
                        </ConceptBox>
                    </div>
                </Card>
                
                <div className="grid lg:grid-cols-2 gap-6">
                    <Card title="‚öôÔ∏è Simulador" icon="‚öôÔ∏è">
                        <div className="space-y-3">
                            <Slider label="CF" value={costFix} onChange={setCostFix} min={100} max={5000} step={100} suffix="‚Ç¨" />
                            <Slider label={idioma === 'val' ? "CV lineal (a)" : "Linear VC (a)"} value={costVarA} onChange={setCostVarA} min={1} max={50} suffix="‚Ç¨" />
                            <Slider label={idioma === 'val' ? "CV quadr√†tic (b)" : "Quadratic VC (b)"} value={costVarB} onChange={setCostVarB} min={0} max={0.2} step={0.01} />
                            <Slider label="Q" value={quantitat} onChange={setQuantitat} min={10} max={250} step={10} />
                        </div>
                        <div className="grid grid-cols-3 gap-2 mt-4">
                            <ResultCard title="CT" value={costos.CT + "‚Ç¨"} color="green" />
                            <ResultCard title="CMe" value={costos.CMe + "‚Ç¨"} color="amber" />
                            <ResultCard title="CMg" value={costos.CMg + "‚Ç¨"} color="violet" />
                        </div>
                    </Card>
                    <Card>
                        <div className="h-72">
                            <ResponsiveContainer width="100%" height="100%">
                                <LineChart data={dadesCostos}>
                                    <CartesianGrid strokeDasharray="3 3" />
                                    <XAxis dataKey="q" />
                                    <YAxis />
                                    <Tooltip />
                                    <Legend />
                                    <Line type="monotone" dataKey="CMe" stroke="#f59e0b" strokeWidth={2} dot={false} />
                                    <Line type="monotone" dataKey="CVMe" stroke="#ec4899" strokeWidth={2} dot={false} />
                                    <Line type="monotone" dataKey="CMg" stroke="#8b5cf6" strokeWidth={2} dot={false} />
                                </LineChart>
                            </ResponsiveContainer>
                        </div>
                        <p className="text-center text-sm text-gray-500 mt-2">{idioma === 'val' ? 'CMg talla CMe i CVMe als m√≠nims' : 'MC intersects AC and AVC at minimums'}</p>
                    </Card>
                </div>
            </div>
        );
    };

    // ========================================================================
    // SECTION: ESTRUCTURES DE MERCAT (Complet amb Cournot, Stackelberg, Bertrand)
    // ========================================================================
    const EstructuresMercat = () => {
        const [tab, setTab] = useState('perfecta');
        
        // Compet√®ncia Perfecta
        const [cpPreu, setCpPreu] = useState(20);
        const [cpCF, setCpCF] = useState(100);
        const [cpA, setCpA] = useState(5);
        const [cpB, setCpB] = useState(0.1);
        
        // Monopoli
        const [monA, setMonA] = useState(100);
        const [monB, setMonB] = useState(1);
        const [monCMg, setMonCMg] = useState(20);
        
        // Oligopoli
        const [oligA, setOligA] = useState(100);
        const [oligB, setOligB] = useState(1);
        const [oligC1, setOligC1] = useState(10);
        const [oligC2, setOligC2] = useState(10);
        
        const competenciaPerfecta = useMemo(() => {
            const qOpt = Math.max(0, (cpPreu - cpA) / (2 * cpB));
            const CV = cpA * qOpt + cpB * qOpt * qOpt;
            const CT = cpCF + CV;
            const IT = cpPreu * qOpt;
            return { q: qOpt.toFixed(1), benefici: (IT - CT).toFixed(0), CMe: (CT/qOpt).toFixed(2), CMg: (cpA + 2*cpB*qOpt).toFixed(2) };
        }, [cpPreu, cpCF, cpA, cpB]);
        
        const monopoli = useMemo(() => {
            // IMg = CMg => a - 2bQ = CMg => Q = (a-CMg)/2b
            const qMon = Math.max(0, (monA - monCMg) / (2 * monB));
            const pMon = monA - monB * qMon;
            const benefici = (pMon - monCMg) * qMon;
            const qCP = (monA - monCMg) / monB;
            const DWL = 0.5 * (qCP - qMon) * (pMon - monCMg);
            const lerner = (pMon - monCMg) / pMon;
            return { qMon: qMon.toFixed(1), pMon: pMon.toFixed(2), benefici: benefici.toFixed(0), qCP: qCP.toFixed(1), pCP: monCMg.toFixed(2), DWL: DWL.toFixed(0), lerner: lerner.toFixed(2) };
        }, [monA, monB, monCMg]);
        
        const cournot = useMemo(() => {
            // Funcions de reacci√≥: q1 = (a - c1 - b*q2) / 2b
            // Equilibri Nash-Cournot: q1* = (a - 2c1 + c2) / 3b
            const q1 = Math.max(0, (oligA - 2*oligC1 + oligC2) / (3 * oligB));
            const q2 = Math.max(0, (oligA - 2*oligC2 + oligC1) / (3 * oligB));
            const Q = q1 + q2;
            const P = oligA - oligB * Q;
            const profit1 = (P - oligC1) * q1;
            const profit2 = (P - oligC2) * q2;
            return { q1: q1.toFixed(1), q2: q2.toFixed(1), Q: Q.toFixed(1), P: P.toFixed(2), profit1: profit1.toFixed(0), profit2: profit2.toFixed(0) };
        }, [oligA, oligB, oligC1, oligC2]);
        
        const stackelberg = useMemo(() => {
            // L√≠der (1) anticipa reacci√≥ del seguidor (2)
            // q2 = (a - c2 - b*q1) / 2b (reacci√≥ seguidor)
            // L√≠der maximitza: max (a - b(q1+q2) - c1)*q1 subjecte a q2 = ...
            // q1* = (a - c1) / 2b (si c1=c2)
            // q2* = (a - c2) / 4b
            const q1 = Math.max(0, (oligA - 2*oligC1 + oligC2) / (2 * oligB));
            const q2 = Math.max(0, (oligA - 2*oligC2 - oligB*q1 + oligC1) / (2 * oligB));
            const Q = q1 + q2;
            const P = Math.max(0, oligA - oligB * Q);
            const profit1 = (P - oligC1) * q1;
            const profit2 = (P - oligC2) * q2;
            return { q1: q1.toFixed(1), q2: q2.toFixed(1), Q: Q.toFixed(1), P: P.toFixed(2), profit1: profit1.toFixed(0), profit2: profit2.toFixed(0) };
        }, [oligA, oligB, oligC1, oligC2]);
        
        const bertrand = useMemo(() => {
            // Compet√®ncia en preus amb productes homogenis
            // Resultat: P = CMg (paradoxa de Bertrand)
            const P = Math.min(oligC1, oligC2);
            const Q = (oligA - P) / oligB;
            // Qui t√© menor cost serveix tot el mercat
            const q1 = oligC1 <= oligC2 ? Q : 0;
            const q2 = oligC2 < oligC1 ? Q : (oligC1 === oligC2 ? Q/2 : 0);
            return { P: P.toFixed(2), Q: Q.toFixed(1), profit: "0 (Paradoxa!)" };
        }, [oligA, oligB, oligC1, oligC2]);
        
        const dadesMonopoli = useMemo(() => {
            const d = [];
            for (let q = 0; q <= monA/monB; q += 2) {
                d.push({ q, P: Math.max(0, monA - monB*q), IMg: monA - 2*monB*q, CMg: monCMg });
            }
            return d;
        }, [monA, monB, monCMg]);
        
        const txt = { val: { cp: 'Comp. Perfecta', mon: 'Monopoli', olig: 'Oligopoli', comp: 'Comparaci√≥' }, es: { cp: 'Comp. Perfecta', mon: 'Monopolio', olig: 'Oligopolio', comp: 'Comparaci√≥n' }, en: { cp: 'Perfect Comp.', mon: 'Monopoly', olig: 'Oligopoly', comp: 'Comparison' } }[idioma];
        
        return (
            <div className="space-y-6">
                <div>
                    <h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Estructures de Mercat' : idioma === 'es' ? 'Estructuras de Mercado' : 'Market Structures'}</h1>
                    <p className="text-gray-500">{idioma === 'val' ? 'Com les empreses fixen preus i quantitats segons el tipus de mercat' : 'How firms set prices and quantities by market type'}</p>
                </div>
                
                <Tabs tabs={[
                    { id: 'perfecta', label: '‚öñÔ∏è ' + txt.cp },
                    { id: 'monopoli', label: 'üëë ' + txt.mon },
                    { id: 'oligopoli', label: '‚öîÔ∏è ' + txt.olig },
                    { id: 'comparacio', label: 'üìä ' + txt.comp },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'perfecta' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "‚öñÔ∏è Compet√®ncia Perfecta" : "‚öñÔ∏è Perfect Competition"} icon="‚öñÔ∏è">
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <div className="bg-green-50 p-4 rounded-xl mb-4">
                                        <h4 className="font-bold text-green-700 mb-2">{idioma === 'val' ? 'Caracter√≠stiques' : 'Characteristics'}</h4>
                                        <ul className="text-sm text-green-600 space-y-1">
                                            <li>‚úì {idioma === 'val' ? 'Molts compradors i venedors' : 'Many buyers and sellers'}</li>
                                            <li>‚úì {idioma === 'val' ? 'Producte homogeni' : 'Homogeneous product'}</li>
                                            <li>‚úì {idioma === 'val' ? 'Informaci√≥ perfecta' : 'Perfect information'}</li>
                                            <li>‚úì {idioma === 'val' ? 'Lliure entrada/sortida' : 'Free entry/exit'}</li>
                                            <li>‚úì {idioma === 'val' ? 'Empreses preuacceptants' : 'Price-taking firms'}</li>
                                        </ul>
                                    </div>
                                    <ConceptBox title={idioma === 'val' ? "Condici√≥ Curt Termini" : "Short-Run Condition"} color="pink">
                                        <FormulaBox formula="P = CMg" desc={idioma === 'val' ? "Produir on P = Cost Marginal" : "Produce where P = Marginal Cost"} />
                                    </ConceptBox>
                                    <ConceptBox title={idioma === 'val' ? "Equilibri Llarg Termini" : "Long-Run Equilibrium"} color="blue">
                                        <FormulaBox formula="P = CMg = CMe" desc={idioma === 'val' ? "Benefici econ√≤mic = 0" : "Economic profit = 0"} />
                                    </ConceptBox>
                                </div>
                                <div className="space-y-3">
                                    <Slider label={idioma === 'val' ? "Preu Mercat" : "Market Price"} value={cpPreu} onChange={setCpPreu} min={5} max={50} suffix="‚Ç¨" />
                                    <Slider label="CF" value={cpCF} onChange={setCpCF} min={0} max={500} step={10} suffix="‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "CV lineal" : "Linear VC"} value={cpA} onChange={setCpA} min={1} max={20} suffix="‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "CV quadr√†tic" : "Quadratic VC"} value={cpB} onChange={setCpB} min={0.01} max={0.5} step={0.01} />
                                    <div className="grid grid-cols-2 gap-2 mt-4">
                                        <ResultCard title="Q*" value={competenciaPerfecta.q} color="pink" />
                                        <ResultCard title={idioma === 'val' ? "Benefici" : "Profit"} value={competenciaPerfecta.benefici + "‚Ç¨"} color={Number(competenciaPerfecta.benefici) >= 0 ? "green" : "red"} />
                                    </div>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'monopoli' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üëë Monopoli" : "üëë Monopoly"} icon="üëë">
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <div className="bg-red-50 p-4 rounded-xl mb-4">
                                        <h4 className="font-bold text-red-700 mb-2">{idioma === 'val' ? 'Caracter√≠stiques' : 'Characteristics'}</h4>
                                        <ul className="text-sm text-red-600 space-y-1">
                                            <li>‚úó {idioma === 'val' ? 'Un sol venedor' : 'Single seller'}</li>
                                            <li>‚úó {idioma === 'val' ? 'Sense substituts propers' : 'No close substitutes'}</li>
                                            <li>‚úó {idioma === 'val' ? 'Barreres entrada' : 'Entry barriers'}</li>
                                            <li>‚úó {idioma === 'val' ? 'Poder de mercat' : 'Market power'}</li>
                                        </ul>
                                    </div>
                                    <ConceptBox title={idioma === 'val' ? "Maximitzaci√≥ Benefici" : "Profit Maximization"} color="pink">
                                        <FormulaBox formula="IMg = CMg" />
                                        <p className="text-sm">{idioma === 'val' ? 'Per demanda P = a - bQ:' : 'For demand P = a - bQ:'}</p>
                                        <FormulaBox formula="IMg = a - 2bQ" desc={idioma === 'val' ? "Doble pendent que demanda" : "Twice demand slope"} />
                                    </ConceptBox>
                                    <ConceptBox title={idioma === 'val' ? "√çndex de Lerner" : "Lerner Index"} color="violet">
                                        <FormulaBox formula="L = (P-CMg)/P = 1/|Ed|" desc={idioma === 'val' ? "Mesura poder de mercat (0 a 1)" : "Measures market power (0 to 1)"} />
                                    </ConceptBox>
                                </div>
                                <div className="space-y-3">
                                    <Slider label={idioma === 'val' ? "Demanda a (intercepci√≥)" : "Demand a (intercept)"} value={monA} onChange={setMonA} min={50} max={200} />
                                    <Slider label={idioma === 'val' ? "Demanda b (pendent)" : "Demand b (slope)"} value={monB} onChange={setMonB} min={0.5} max={3} step={0.1} />
                                    <Slider label="CMg" value={monCMg} onChange={setMonCMg} min={5} max={50} />
                                </div>
                            </div>
                        </Card>
                        
                        <div className="grid lg:grid-cols-2 gap-6">
                            <Card>
                                <div className="h-64">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <LineChart data={dadesMonopoli}>
                                            <CartesianGrid strokeDasharray="3 3" />
                                            <XAxis dataKey="q" />
                                            <YAxis />
                                            <Tooltip />
                                            <Legend />
                                            <Line type="monotone" dataKey="P" stroke="#3b82f6" strokeWidth={2} dot={false} name={idioma === 'val' ? "Demanda" : "Demand"} />
                                            <Line type="monotone" dataKey="IMg" stroke="#ec4899" strokeWidth={2} dot={false} name="IMg" />
                                            <Line type="monotone" dataKey="CMg" stroke="#10b981" strokeWidth={2} dot={false} name="CMg" />
                                        </LineChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                            <Card>
                                <h4 className="font-bold mb-4">{idioma === 'val' ? 'Monopoli vs Compet√®ncia Perfecta' : 'Monopoly vs Perfect Competition'}</h4>
                                <table className="w-full text-sm">
                                    <thead><tr className="bg-gray-100"><th className="p-2"></th><th className="p-2">{idioma === 'val' ? 'Monopoli' : 'Monopoly'}</th><th className="p-2">CP</th></tr></thead>
                                    <tbody>
                                        <tr className="border-b"><td className="p-2">Q</td><td className="p-2 text-center text-red-600 font-bold">{monopoli.qMon}</td><td className="p-2 text-center text-green-600 font-bold">{monopoli.qCP}</td></tr>
                                        <tr className="border-b"><td className="p-2">P</td><td className="p-2 text-center text-red-600 font-bold">{monopoli.pMon}‚Ç¨</td><td className="p-2 text-center text-green-600 font-bold">{monopoli.pCP}‚Ç¨</td></tr>
                                        <tr className="border-b"><td className="p-2">{idioma === 'val' ? 'Benefici' : 'Profit'}</td><td className="p-2 text-center text-red-600 font-bold">{monopoli.benefici}‚Ç¨</td><td className="p-2 text-center text-green-600 font-bold">0‚Ç¨</td></tr>
                                        <tr><td className="p-2">Lerner</td><td className="p-2 text-center text-red-600 font-bold">{monopoli.lerner}</td><td className="p-2 text-center text-green-600 font-bold">0</td></tr>
                                    </tbody>
                                </table>
                                <div className="mt-4 p-3 bg-amber-50 rounded-lg text-sm">
                                    <strong>DWL:</strong> {monopoli.DWL}‚Ç¨ {idioma === 'val' ? '(P√®rdua efici√®ncia)' : '(Deadweight Loss)'}
                                </div>
                            </Card>
                        </div>
                    </div>
                )}
                
                {tab === 'oligopoli' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "‚öîÔ∏è Oligopoli" : "‚öîÔ∏è Oligopoly"} icon="‚öîÔ∏è">
                            <p className="text-gray-700 mb-4">{idioma === 'val' ? 'Pocs venedors, interacci√≥ estrat√®gica. Resultats depenen del tipus de compet√®ncia.' : 'Few sellers, strategic interaction. Results depend on competition type.'}</p>
                            <div className="grid md:grid-cols-2 gap-6">
                                <div className="space-y-3">
                                    <Slider label={idioma === 'val' ? "Demanda a" : "Demand a"} value={oligA} onChange={setOligA} min={50} max={200} />
                                    <Slider label={idioma === 'val' ? "Demanda b" : "Demand b"} value={oligB} onChange={setOligB} min={0.5} max={3} step={0.1} />
                                    <Slider label={idioma === 'val' ? "CMg Empresa 1" : "MC Firm 1"} value={oligC1} onChange={setOligC1} min={5} max={40} />
                                    <Slider label={idioma === 'val' ? "CMg Empresa 2" : "MC Firm 2"} value={oligC2} onChange={setOligC2} min={5} max={40} />
                                </div>
                                <div className="bg-violet-50 p-4 rounded-xl">
                                    <h4 className="font-bold text-violet-700 mb-3">{idioma === 'val' ? 'Tipus de Compet√®ncia' : 'Competition Types'}</h4>
                                    <div className="space-y-2 text-sm">
                                        <div className="p-2 bg-white rounded"><strong>Cournot:</strong> {idioma === 'val' ? 'Compet√®ncia en QUANTITATS simult√†nia' : 'Simultaneous QUANTITY competition'}</div>
                                        <div className="p-2 bg-white rounded"><strong>Stackelberg:</strong> {idioma === 'val' ? 'Compet√®ncia seq√ºencial (l√≠der-seguidor)' : 'Sequential competition (leader-follower)'}</div>
                                        <div className="p-2 bg-white rounded"><strong>Bertrand:</strong> {idioma === 'val' ? 'Compet√®ncia en PREUS' : 'PRICE competition'}</div>
                                    </div>
                                </div>
                            </div>
                        </Card>
                        
                        <div className="grid md:grid-cols-3 gap-4">
                            <Card className="bg-blue-50">
                                <h4 className="font-bold text-blue-700 mb-3">Cournot-Nash</h4>
                                <FormulaBox formula="q‚ÇÅ* = (a-2c‚ÇÅ+c‚ÇÇ)/3b" />
                                <div className="grid grid-cols-2 gap-2 text-sm">
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">q‚ÇÅ</span><br/><strong>{cournot.q1}</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">q‚ÇÇ</span><br/><strong>{cournot.q2}</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">P</span><br/><strong>{cournot.P}‚Ç¨</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">Q</span><br/><strong>{cournot.Q}</strong></div>
                                </div>
                                <p className="text-xs text-blue-600 mt-2">œÄ‚ÇÅ={cournot.profit1}‚Ç¨, œÄ‚ÇÇ={cournot.profit2}‚Ç¨</p>
                            </Card>
                            
                            <Card className="bg-amber-50">
                                <h4 className="font-bold text-amber-700 mb-3">Stackelberg</h4>
                                <p className="text-xs mb-2">{idioma === 'val' ? 'Empresa 1 √©s l√≠der' : 'Firm 1 is leader'}</p>
                                <div className="grid grid-cols-2 gap-2 text-sm">
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">q‚ÇÅ (L)</span><br/><strong>{stackelberg.q1}</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">q‚ÇÇ (S)</span><br/><strong>{stackelberg.q2}</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">P</span><br/><strong>{stackelberg.P}‚Ç¨</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">Q</span><br/><strong>{stackelberg.Q}</strong></div>
                                </div>
                                <p className="text-xs text-amber-600 mt-2">œÄ‚ÇÅ={stackelberg.profit1}‚Ç¨, œÄ‚ÇÇ={stackelberg.profit2}‚Ç¨</p>
                            </Card>
                            
                            <Card className="bg-red-50">
                                <h4 className="font-bold text-red-700 mb-3">Bertrand</h4>
                                <p className="text-xs mb-2">{idioma === 'val' ? 'Paradoxa: resultat = CP!' : 'Paradox: result = PC!'}</p>
                                <FormulaBox formula="P = min(c‚ÇÅ, c‚ÇÇ)" />
                                <div className="grid grid-cols-2 gap-2 text-sm">
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">P</span><br/><strong>{bertrand.P}‚Ç¨</strong></div>
                                    <div className="p-2 bg-white rounded text-center"><span className="text-gray-500">Q</span><br/><strong>{bertrand.Q}</strong></div>
                                </div>
                                <p className="text-xs text-red-600 mt-2">{idioma === 'val' ? 'Beneficis: ' : 'Profits: '}{bertrand.profit}</p>
                            </Card>
                        </div>
                        
                        <Card title={idioma === 'val' ? "üìê Funcions de Reacci√≥ Cournot" : "üìê Cournot Reaction Functions"} icon="üìê">
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <FormulaBox formula="q‚ÇÅ(q‚ÇÇ) = (a - c‚ÇÅ - b¬∑q‚ÇÇ) / 2b" desc={idioma === 'val' ? "Funci√≥ reacci√≥ empresa 1" : "Firm 1 reaction function"} />
                                    <FormulaBox formula="q‚ÇÇ(q‚ÇÅ) = (a - c‚ÇÇ - b¬∑q‚ÇÅ) / 2b" desc={idioma === 'val' ? "Funci√≥ reacci√≥ empresa 2" : "Firm 2 reaction function"} />
                                    <p className="text-sm text-gray-600 mt-4">{idioma === 'val' ? "L'equilibri Nash-Cournot √©s la intersecci√≥ de les dues funcions de reacci√≥." : "The Nash-Cournot equilibrium is the intersection of both reaction functions."}</p>
                                </div>
                                <div className="bg-gray-100 rounded-xl p-4 flex items-center justify-center">
                                    <div className="text-center">
                                        <p className="text-4xl mb-2">üìä</p>
                                        <p className="text-sm text-gray-600">{idioma === 'val' ? 'Les funcions de reacci√≥ tenen pendent negatiu' : 'Reaction functions have negative slope'}</p>
                                    </div>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'comparacio' && (
                    <Card title={idioma === 'val' ? "üìä Comparaci√≥ Estructures de Mercat" : "üìä Market Structure Comparison"} icon="üìä">
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm">
                                <thead>
                                    <tr className="bg-gray-100">
                                        <th className="p-3 text-left">{idioma === 'val' ? 'Caracter√≠stica' : 'Feature'}</th>
                                        <th className="p-3 text-center">CP</th>
                                        <th className="p-3 text-center">{idioma === 'val' ? 'Comp. Monopol√≠stica' : 'Monop. Comp.'}</th>
                                        <th className="p-3 text-center">{idioma === 'val' ? 'Oligopoli' : 'Oligopoly'}</th>
                                        <th className="p-3 text-center">{idioma === 'val' ? 'Monopoli' : 'Monopoly'}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr className="border-b"><td className="p-3">{idioma === 'val' ? 'Empreses' : 'Firms'}</td><td className="p-3 text-center">{idioma === 'val' ? 'Moltes' : 'Many'}</td><td className="p-3 text-center">{idioma === 'val' ? 'Moltes' : 'Many'}</td><td className="p-3 text-center">{idioma === 'val' ? 'Poques' : 'Few'}</td><td className="p-3 text-center">1</td></tr>
                                    <tr className="border-b"><td className="p-3">{idioma === 'val' ? 'Producte' : 'Product'}</td><td className="p-3 text-center">{idioma === 'val' ? 'Homogeni' : 'Homogeneous'}</td><td className="p-3 text-center">{idioma === 'val' ? 'Diferenciat' : 'Differentiated'}</td><td className="p-3 text-center">{idioma === 'val' ? 'Pot ser ambd√≥s' : 'Can be both'}</td><td className="p-3 text-center">{idioma === 'val' ? '√önic' : 'Unique'}</td></tr>
                                    <tr className="border-b"><td className="p-3">{idioma === 'val' ? 'Barreres entrada' : 'Entry barriers'}</td><td className="p-3 text-center text-green-600">No</td><td className="p-3 text-center text-green-600">{idioma === 'val' ? 'Baixes' : 'Low'}</td><td className="p-3 text-center text-amber-600">{idioma === 'val' ? 'Altes' : 'High'}</td><td className="p-3 text-center text-red-600">{idioma === 'val' ? 'Molt altes' : 'Very high'}</td></tr>
                                    <tr className="border-b"><td className="p-3">{idioma === 'val' ? 'Poder fixar preus' : 'Pricing power'}</td><td className="p-3 text-center text-green-600">{idioma === 'val' ? 'Cap' : 'None'}</td><td className="p-3 text-center text-amber-600">{idioma === 'val' ? 'Limitat' : 'Limited'}</td><td className="p-3 text-center text-amber-600">{idioma === 'val' ? 'Moderat' : 'Moderate'}</td><td className="p-3 text-center text-red-600">{idioma === 'val' ? 'Alt' : 'High'}</td></tr>
                                    <tr className="border-b"><td className="p-3">{idioma === 'val' ? 'Benefici LP' : 'LR Profit'}</td><td className="p-3 text-center">0</td><td className="p-3 text-center">0</td><td className="p-3 text-center">{">0"}</td><td className="p-3 text-center">{">0"}</td></tr>
                                    <tr><td className="p-3">{idioma === 'val' ? 'Efici√®ncia' : 'Efficiency'}</td><td className="p-3 text-center text-green-600">{idioma === 'val' ? 'M√†xima' : 'Maximum'}</td><td className="p-3 text-center text-amber-600">{idioma === 'val' ? 'Alta' : 'High'}</td><td className="p-3 text-center text-amber-600">{idioma === 'val' ? 'Mitjana' : 'Medium'}</td><td className="p-3 text-center text-red-600">{idioma === 'val' ? 'Baixa' : 'Low'}</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div className="mt-6 p-4 bg-gradient-to-r from-green-100 to-blue-100 rounded-xl">
                            <h4 className="font-bold text-gray-800 mb-2">{idioma === 'val' ? 'Ordenaci√≥ per Quantitat i Preu' : 'Ordering by Quantity and Price'}</h4>
                            <p className="text-sm"><strong>Q:</strong> CP {">"} Cournot {">"} Stackelberg {">"} {idioma === 'val' ? 'Monopoli' : 'Monopoly'}</p>
                            <p className="text-sm"><strong>P:</strong> {idioma === 'val' ? 'Monopoli' : 'Monopoly'} {">"} Stackelberg {">"} Cournot {">"} CP (= Bertrand)</p>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: FALLADES DE MERCAT
    // ========================================================================
    const FalladesMercat = () => {
        const [tab, setTab] = useState('externalitats');
        const [qPrivat, setQPrivat] = useState(100);
        const [costExtern, setCostExtern] = useState(10);
        
        const txt = { val: { title: 'Fallades de Mercat', ext: 'Externalitats', bens: 'B√©ns P√∫blics', asim: 'Informaci√≥ Asim√®trica' }, es: { title: 'Fallos de Mercado', ext: 'Externalidades', bens: 'Bienes P√∫blicos', asim: 'Informaci√≥n Asim√©trica' }, en: { title: 'Market Failures', ext: 'Externalities', bens: 'Public Goods', asim: 'Asymmetric Information' } }[idioma];
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{txt.title}</h1></div>
                
                <Tabs tabs={[
                    { id: 'externalitats', label: 'üè≠ ' + txt.ext },
                    { id: 'bens', label: 'üèõÔ∏è ' + txt.bens },
                    { id: 'asimetria', label: 'üëÅÔ∏è ' + txt.asim },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'externalitats' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üè≠ Externalitats" : "üè≠ Externalities"} icon="üè≠">
                            <p className="text-gray-700 mb-4">{idioma === 'val' ? "Efectes sobre tercers no reflectits en el preu de mercat." : "Effects on third parties not reflected in market price."}</p>
                            <div className="grid md:grid-cols-2 gap-6">
                                <ConceptBox title={idioma === 'val' ? "Externalitat Negativa" : "Negative Externality"} color="red">
                                    <p>{idioma === 'val' ? "Cost social > Cost privat" : "Social cost > Private cost"}</p>
                                    <p className="text-sm mt-2">{idioma === 'val' ? "Ex: Pol¬∑luci√≥, soroll, tabac" : "Ex: Pollution, noise, smoking"}</p>
                                    <p className="font-bold mt-2">{idioma === 'val' ? "Mercat produeix MASSA" : "Market produces TOO MUCH"}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Externalitat Positiva" : "Positive Externality"} color="green">
                                    <p>{idioma === 'val' ? "Benefici social > Benefici privat" : "Social benefit > Private benefit"}</p>
                                    <p className="text-sm mt-2">{idioma === 'val' ? "Ex: Educaci√≥, vacunes, R+D" : "Ex: Education, vaccines, R&D"}</p>
                                    <p className="font-bold mt-2">{idioma === 'val' ? "Mercat produeix MASSA POC" : "Market produces TOO LITTLE"}</p>
                                </ConceptBox>
                            </div>
                        </Card>
                        <Card title={idioma === 'val' ? "üîß Solucions" : "üîß Solutions"} icon="üîß">
                            <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                                <div className="p-4 bg-blue-50 rounded-xl">
                                    <h4 className="font-bold text-blue-700">Pigou</h4>
                                    <p className="text-sm text-blue-600">{idioma === 'val' ? "Impostos/Subvencions per igualar cost social" : "Taxes/Subsidies to equal social cost"}</p>
                                </div>
                                <div className="p-4 bg-green-50 rounded-xl">
                                    <h4 className="font-bold text-green-700">Coase</h4>
                                    <p className="text-sm text-green-600">{idioma === 'val' ? "Negociaci√≥ privada si drets propietat clars" : "Private negotiation if property rights clear"}</p>
                                </div>
                                <div className="p-4 bg-amber-50 rounded-xl">
                                    <h4 className="font-bold text-amber-700">{idioma === 'val' ? "Regulaci√≥" : "Regulation"}</h4>
                                    <p className="text-sm text-amber-600">{idioma === 'val' ? "L√≠mits quantitatius (quotes, prohibicions)" : "Quantity limits (quotas, bans)"}</p>
                                </div>
                                <div className="p-4 bg-violet-50 rounded-xl">
                                    <h4 className="font-bold text-violet-700">{idioma === 'val' ? "Mercats Permisos" : "Permit Markets"}</h4>
                                    <p className="text-sm text-violet-600">{idioma === 'val' ? "Cap and trade (emissions CO‚ÇÇ)" : "Cap and trade (CO‚ÇÇ emissions)"}</p>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'bens' && (
                    <Card title={idioma === 'val' ? "üèõÔ∏è B√©ns P√∫blics" : "üèõÔ∏è Public Goods"} icon="üèõÔ∏è">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <div className="bg-blue-50 p-4 rounded-xl mb-4">
                                    <h4 className="font-bold text-blue-700 mb-2">{idioma === 'val' ? "Caracter√≠stiques" : "Characteristics"}</h4>
                                    <p className="mb-2"><strong>{idioma === 'val' ? "No rivalitat:" : "Non-rivalry:"}</strong> {idioma === 'val' ? "El consum d'un no redueix el d'un altre" : "One's consumption doesn't reduce another's"}</p>
                                    <p><strong>{idioma === 'val' ? "No exclusi√≥:" : "Non-excludability:"}</strong> {idioma === 'val' ? "No es pot impedir l'acc√©s" : "Cannot prevent access"}</p>
                                </div>
                                <ConceptBox title={idioma === 'val' ? "Problema del Free Rider" : "Free Rider Problem"} color="red">
                                    {idioma === 'val' ? "Ning√∫ vol pagar perqu√® pot gaudir-ne de franc. Resultat: subprovisi√≥ pel mercat." : "Nobody wants to pay because they can enjoy for free. Result: market underprovision."}
                                </ConceptBox>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm">
                                    <thead><tr className="bg-gray-100"><th className="p-2"></th><th className="p-2">{idioma === 'val' ? "Rival" : "Rival"}</th><th className="p-2">{idioma === 'val' ? "No Rival" : "Non-rival"}</th></tr></thead>
                                    <tbody>
                                        <tr className="border-b"><td className="p-2 font-bold">{idioma === 'val' ? "Exclo√Øble" : "Excludable"}</td><td className="p-2 bg-green-50">{idioma === 'val' ? "Privat (pa, roba)" : "Private (bread, clothes)"}</td><td className="p-2 bg-blue-50">{idioma === 'val' ? "Club (cinema, gimn√†s)" : "Club (cinema, gym)"}</td></tr>
                                        <tr><td className="p-2 font-bold">{idioma === 'val' ? "No exclo√Øble" : "Non-excludable"}</td><td className="p-2 bg-amber-50">{idioma === 'val' ? "Com√∫ (pesca, bosc)" : "Common (fishing, forest)"}</td><td className="p-2 bg-red-50">{idioma === 'val' ? "P√∫blic (defensa, fars)" : "Public (defense, lighthouses)"}</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'asimetria' && (
                    <Card title={idioma === 'val' ? "üëÅÔ∏è Informaci√≥ Asim√®trica" : "üëÅÔ∏è Asymmetric Information"} icon="üëÅÔ∏è">
                        <div className="grid md:grid-cols-2 gap-6">
                            <ConceptBox title={idioma === 'val' ? "Selecci√≥ Adversa" : "Adverse Selection"} color="red">
                                <p className="mb-2">{idioma === 'val' ? "ABANS de la transacci√≥. Una part t√© m√©s informaci√≥." : "BEFORE transaction. One party has more information."}</p>
                                <p className="text-sm">{idioma === 'val' ? "Ex: Cotxes usats (Akerlof), assegurances de salut" : "Ex: Used cars (Akerlof), health insurance"}</p>
                                <p className="mt-2 font-bold">{idioma === 'val' ? "Soluci√≥: Senyalitzaci√≥ (garanties, t√≠tols)" : "Solution: Signaling (warranties, degrees)"}</p>
                            </ConceptBox>
                            <ConceptBox title={idioma === 'val' ? "Risc Moral" : "Moral Hazard"} color="amber">
                                <p className="mb-2">{idioma === 'val' ? "DESPR√âS de la transacci√≥. Comportament canvia." : "AFTER transaction. Behavior changes."}</p>
                                <p className="text-sm">{idioma === 'val' ? "Ex: Assegurat que es descuida, empleat que no s'esfor√ßa" : "Ex: Insured person becomes careless, employee doesn't try"}</p>
                                <p className="mt-2 font-bold">{idioma === 'val' ? "Soluci√≥: Incentius, monitoratge, franqu√≠cies" : "Solution: Incentives, monitoring, deductibles"}</p>
                            </ConceptBox>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: MACROECONOMIA (PIB, IS-LM, AD-AS)
    // ========================================================================
    const Macroeconomia = () => {
        const [tab, setTab] = useState('pib');
        
        // PIB
        const [pibC, setPibC] = useState(600);
        const [pibI, setPibI] = useState(200);
        const [pibG, setPibG] = useState(180);
        const [pibX, setPibX] = useState(120);
        const [pibM, setPibM] = useState(150);
        
        // IS-LM
        const [isC0, setIsC0] = useState(100);
        const [isPMC, setIsPMC] = useState(0.8);
        const [isI0, setIsI0] = useState(200);
        const [isb, setIsb] = useState(50);
        const [isG, setIsG] = useState(150);
        const [lmM, setLmM] = useState(500);
        const [lmk, setLmk] = useState(0.5);
        const [lmh, setLmh] = useState(100);
        
        // AD-AS
        const [adY, setAdY] = useState(1000);
        const [adP, setAdP] = useState(100);
        
        const pib = useMemo(() => {
            const total = pibC + pibI + pibG + (pibX - pibM);
            return { total, xn: pibX - pibM, percC: ((pibC/total)*100).toFixed(1), percI: ((pibI/total)*100).toFixed(1), percG: ((pibG/total)*100).toFixed(1) };
        }, [pibC, pibI, pibG, pibX, pibM]);
        
        const islm = useMemo(() => {
            const mult = 1 / (1 - isPMC);
            const A = isC0 + isI0 + isG;
            const Ystar = (mult * A + mult * isb * lmM / lmh) / (1 + mult * isb * lmk / lmh);
            const rstar = (lmk * Ystar - lmM) / lmh;
            
            const dades = [];
            for (let Y = 100; Y <= 2000; Y += 50) {
                const rIS = (A - Y / mult) / isb;
                const rLM = (lmk * Y - lmM) / lmh;
                dades.push({ Y, IS: rIS > -0.1 ? rIS : null, LM: rLM });
            }
            return { Y: Ystar.toFixed(0), r: (rstar * 100).toFixed(1), mult: mult.toFixed(2), dades };
        }, [isC0, isPMC, isI0, isb, isG, lmM, lmk, lmh]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">Macroeconomia</h1></div>
                
                <Tabs tabs={[
                    { id: 'pib', label: 'üìä PIB' },
                    { id: 'islm', label: 'üìâ IS-LM' },
                    { id: 'adas', label: 'üìà AD-AS' },
                    { id: 'phillips', label: 'üìä Phillips' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'pib' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìä Producte Interior Brut" : "üìä Gross Domestic Product"} icon="üìä">
                            <FormulaBox formula="PIB = C + I + G + (X - M)" desc={idioma === 'val' ? "M√®tode de la Despesa" : "Expenditure Method"} />
                            <div className="grid md:grid-cols-2 gap-6 mt-4">
                                <div className="space-y-3">
                                    <Slider label={idioma === 'val' ? "Consum (C)" : "Consumption (C)"} value={pibC} onChange={setPibC} min={200} max={1000} step={10} suffix="M‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "Inversi√≥ (I)" : "Investment (I)"} value={pibI} onChange={setPibI} min={50} max={500} step={10} suffix="M‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "Despesa P√∫blica (G)" : "Government (G)"} value={pibG} onChange={setPibG} min={50} max={400} step={10} suffix="M‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "Exportacions (X)" : "Exports (X)"} value={pibX} onChange={setPibX} min={0} max={300} step={10} suffix="M‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "Importacions (M)" : "Imports (M)"} value={pibM} onChange={setPibM} min={0} max={300} step={10} suffix="M‚Ç¨" />
                                </div>
                                <div className="bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl p-6 text-white">
                                    <p className="text-white/70">PIB</p>
                                    <p className="text-5xl font-black">{pib.total}M‚Ç¨</p>
                                    <div className="grid grid-cols-4 gap-2 mt-4 text-sm">
                                        <div className="bg-white/20 p-2 rounded text-center"><span className="text-white/70">C</span><br/>{pib.percC}%</div>
                                        <div className="bg-white/20 p-2 rounded text-center"><span className="text-white/70">I</span><br/>{pib.percI}%</div>
                                        <div className="bg-white/20 p-2 rounded text-center"><span className="text-white/70">G</span><br/>{pib.percG}%</div>
                                        <div className="bg-white/20 p-2 rounded text-center"><span className="text-white/70">XN</span><br/>{pib.xn}M‚Ç¨</div>
                                    </div>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'islm' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìâ Model IS-LM" : "üìâ IS-LM Model"} icon="üìâ">
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <ConceptBox title={idioma === 'val' ? "Corba IS (Mercat B√©ns)" : "IS Curve (Goods Market)"} color="pink">
                                        <p>{idioma === 'val' ? "Combinacions Y,r on mercat b√©ns en equilibri (I = S)" : "Y,r combinations where goods market in equilibrium (I = S)"}</p>
                                        <FormulaBox formula="Y = C‚ÇÄ + cY + I‚ÇÄ - br + G" />
                                    </ConceptBox>
                                    <ConceptBox title={idioma === 'val' ? "Corba LM (Mercat Diner)" : "LM Curve (Money Market)"} color="blue">
                                        <p>{idioma === 'val' ? "Combinacions Y,r on mercat diner en equilibri (Md = Ms)" : "Y,r combinations where money market in equilibrium (Md = Ms)"}</p>
                                        <FormulaBox formula="M/P = kY - hr" />
                                    </ConceptBox>
                                </div>
                                <div className="space-y-2">
                                    <p className="text-xs font-bold text-pink-600">IS</p>
                                    <Slider label="C‚ÇÄ" value={isC0} onChange={setIsC0} min={50} max={200} />
                                    <Slider label="PMC (c)" value={isPMC} onChange={setIsPMC} min={0.5} max={0.95} step={0.05} />
                                    <Slider label="I‚ÇÄ" value={isI0} onChange={setIsI0} min={100} max={400} />
                                    <Slider label="b" value={isb} onChange={setIsb} min={10} max={100} />
                                    <Slider label="G" value={isG} onChange={setIsG} min={50} max={300} />
                                    <p className="text-xs font-bold text-blue-600 mt-2">LM</p>
                                    <Slider label="M" value={lmM} onChange={setLmM} min={200} max={1000} />
                                    <Slider label="k" value={lmk} onChange={setLmk} min={0.2} max={1} step={0.05} />
                                    <Slider label="h" value={lmh} onChange={setLmh} min={50} max={200} />
                                </div>
                            </div>
                        </Card>
                        <div className="grid lg:grid-cols-2 gap-6">
                            <Card>
                                <div className="h-72">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <LineChart data={islm.dades}>
                                            <CartesianGrid strokeDasharray="3 3" />
                                            <XAxis dataKey="Y" label={{ value: 'Y', position: 'bottom' }} />
                                            <YAxis label={{ value: 'r', angle: -90, position: 'left' }} domain={[-0.05, 0.15]} tickFormatter={(v) => (v*100).toFixed(0) + '%'} />
                                            <Tooltip formatter={(v) => (v*100).toFixed(1) + '%'} />
                                            <Legend />
                                            <Line type="monotone" dataKey="IS" stroke="#ec4899" strokeWidth={3} dot={false} />
                                            <Line type="monotone" dataKey="LM" stroke="#3b82f6" strokeWidth={3} dot={false} />
                                        </LineChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                            <Card className="bg-gradient-to-br from-green-500 to-emerald-500 text-white border-0">
                                <h4 className="font-bold mb-4">{idioma === 'val' ? "Equilibri IS-LM" : "IS-LM Equilibrium"}</h4>
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="bg-white/20 p-4 rounded-xl text-center">
                                        <p className="text-white/70">Y*</p>
                                        <p className="text-3xl font-black">{islm.Y}</p>
                                    </div>
                                    <div className="bg-white/20 p-4 rounded-xl text-center">
                                        <p className="text-white/70">r*</p>
                                        <p className="text-3xl font-black">{islm.r}%</p>
                                    </div>
                                </div>
                                <div className="mt-4 p-3 bg-white/10 rounded-lg text-sm">
                                    <p>{idioma === 'val' ? 'Multiplicador:' : 'Multiplier:'} <strong>{islm.mult}</strong></p>
                                </div>
                            </Card>
                        </div>
                    </div>
                )}
                
                {tab === 'adas' && (
                    <Card title={idioma === 'val' ? "üìà Model AD-AS" : "üìà AD-AS Model"} icon="üìà">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Demanda Agregada (DA)" : "Aggregate Demand (AD)"} color="pink">
                                    <p>{idioma === 'val' ? "Combinacions P,Y on mercats b√©ns i diner en equilibri simult√†niament." : "P,Y combinations where goods and money markets in simultaneous equilibrium."}</p>
                                    <p className="text-sm mt-2">{idioma === 'val' ? "Pendent negatiu: P‚Üë ‚Üí r‚Üë ‚Üí I‚Üì ‚Üí Y‚Üì" : "Negative slope: P‚Üë ‚Üí r‚Üë ‚Üí I‚Üì ‚Üí Y‚Üì"}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Oferta Agregada Curt Termini (OACT)" : "Short-Run Aggregate Supply (SRAS)"} color="blue">
                                    <p>{idioma === 'val' ? "Pendent positiu: alguns preus/salaris r√≠gids." : "Positive slope: some prices/wages sticky."}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Oferta Agregada Llarg Termini (OALT)" : "Long-Run Aggregate Supply (LRAS)"} color="green">
                                    <p>{idioma === 'val' ? "VERTICAL al PIB potencial. Tots preus flexibles." : "VERTICAL at potential GDP. All prices flexible."}</p>
                                </ConceptBox>
                            </div>
                            <div className="bg-amber-50 p-4 rounded-xl">
                                <h4 className="font-bold text-amber-800 mb-4">{idioma === 'val' ? "Shocks i Pol√≠tiques" : "Shocks and Policies"}</h4>
                                <div className="space-y-3 text-sm">
                                    <div className="p-2 bg-white rounded">
                                        <strong>{idioma === 'val' ? "Expansi√≥ Fiscal/Monet√†ria:" : "Fiscal/Monetary Expansion:"}</strong>
                                        <p>{idioma === 'val' ? "DA‚Üí (CT: Y‚Üë, P‚Üë) (LT: nom√©s P‚Üë)" : "AD‚Üí (SR: Y‚Üë, P‚Üë) (LR: only P‚Üë)"}</p>
                                    </div>
                                    <div className="p-2 bg-white rounded">
                                        <strong>{idioma === 'val' ? "Shock Oferta Negatiu:" : "Negative Supply Shock:"}</strong>
                                        <p>{idioma === 'val' ? "OA‚Üê (Y‚Üì, P‚Üë) Estagflaci√≥!" : "AS‚Üê (Y‚Üì, P‚Üë) Stagflation!"}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'phillips' && (
                    <Card title={idioma === 'val' ? "üìä Corba de Phillips" : "üìä Phillips Curve"} icon="üìä">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Phillips Original" : "Original Phillips"} color="pink">
                                    <p>{idioma === 'val' ? "Relaci√≥ inversa inflaci√≥-atur a curt termini." : "Inverse inflation-unemployment relationship in short run."}</p>
                                    <FormulaBox formula="œÄ = œÄ·µâ - Œ≤(u - u‚Çô)" />
                                </ConceptBox>
                                <ConceptBox title="NAIRU" color="blue">
                                    <p>{idioma === 'val' ? "Taxa d'atur no acceleradora d'inflaci√≥. A llarg termini, no hi ha trade-off." : "Non-Accelerating Inflation Rate of Unemployment. No long-run trade-off."}</p>
                                </ConceptBox>
                            </div>
                            <div className="bg-violet-50 p-4 rounded-xl">
                                <h4 className="font-bold text-violet-700 mb-3">{idioma === 'val' ? "Expectatives" : "Expectations"}</h4>
                                <p className="text-sm text-violet-600 mb-2"><strong>{idioma === 'val' ? "Adaptatives:" : "Adaptive:"}</strong> {idioma === 'val' ? "Basades en passat" : "Based on past"}</p>
                                <p className="text-sm text-violet-600"><strong>{idioma === 'val' ? "Racionals:" : "Rational:"}</strong> {idioma === 'val' ? "Utilitzen tota info disponible" : "Use all available info"}</p>
                            </div>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: ECONOMIA MONET√ÄRIA
    // ========================================================================
    const EconomiaMonetaria = () => {
        const [reserva, setReserva] = useState(10);
        const [baseMonetaria, setBaseMonetaria] = useState(100);
        
        const multiplicadorMonetari = useMemo(() => 1 / (reserva / 100), [reserva]);
        const ofertaMonetaria = useMemo(() => baseMonetaria * multiplicadorMonetari, [baseMonetaria, multiplicadorMonetari]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Economia Monet√†ria' : idioma === 'es' ? 'Econom√≠a Monetaria' : 'Monetary Economics'}</h1></div>
                
                <Card title={idioma === 'val' ? "üèõÔ∏è Banc Central i Pol√≠tica Monet√†ria" : "üèõÔ∏è Central Bank and Monetary Policy"} icon="üèõÔ∏è">
                    <div className="grid md:grid-cols-2 gap-6">
                        <div>
                            <ConceptBox title={idioma === 'val' ? "Funcions Banc Central" : "Central Bank Functions"} color="blue">
                                <ul className="space-y-1">
                                    <li>‚Ä¢ {idioma === 'val' ? "Emetre moneda" : "Issue currency"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Banquer del govern" : "Government banker"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Banquer dels bancs" : "Banks' banker"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Prestador √∫ltima inst√†ncia" : "Lender of last resort"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Control inflaci√≥" : "Inflation control"}</li>
                                </ul>
                            </ConceptBox>
                            <ConceptBox title={idioma === 'val' ? "Instruments" : "Instruments"} color="green">
                                <ul className="space-y-1">
                                    <li>‚Ä¢ {idioma === 'val' ? "Tipus d'inter√®s oficial" : "Policy interest rate"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Operacions mercat obert" : "Open market operations"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Coeficient de reserves" : "Reserve requirement"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Facilitats permanents" : "Standing facilities"}</li>
                                </ul>
                            </ConceptBox>
                        </div>
                        <div>
                            <h4 className="font-bold mb-3">{idioma === 'val' ? "Creaci√≥ de Diners" : "Money Creation"}</h4>
                            <FormulaBox formula="M = m √ó B" desc={idioma === 'val' ? "M = Oferta Monet√†ria, m = Multiplicador, B = Base Monet√†ria" : "M = Money Supply, m = Multiplier, B = Monetary Base"} />
                            <FormulaBox formula="m = 1 / r" desc={idioma === 'val' ? "r = coeficient de reserves" : "r = reserve ratio"} />
                            <div className="space-y-3 mt-4">
                                <Slider label={idioma === 'val' ? "Coeficient Reserves (%)" : "Reserve Ratio (%)"} value={reserva} onChange={setReserva} min={1} max={50} suffix="%" />
                                <Slider label={idioma === 'val' ? "Base Monet√†ria (B)" : "Monetary Base (B)"} value={baseMonetaria} onChange={setBaseMonetaria} min={50} max={500} suffix="M‚Ç¨" />
                            </div>
                            <div className="grid grid-cols-2 gap-3 mt-4">
                                <ResultCard title={idioma === 'val' ? "Multiplicador" : "Multiplier"} value={multiplicadorMonetari.toFixed(1)} color="blue" />
                                <ResultCard title={idioma === 'val' ? "Oferta M" : "Money Supply"} value={ofertaMonetaria.toFixed(0) + "M‚Ç¨"} color="green" />
                            </div>
                        </div>
                    </div>
                </Card>
                
                <Card title={idioma === 'val' ? "üìä Pol√≠tica Monet√†ria Expansiva vs Restrictiva" : "üìä Expansionary vs Contractionary Monetary Policy"} icon="üìä">
                    <div className="grid md:grid-cols-2 gap-6">
                        <div className="bg-green-50 p-4 rounded-xl">
                            <h4 className="font-bold text-green-700 mb-3">{idioma === 'val' ? "Expansiva" : "Expansionary"}</h4>
                            <p className="text-sm text-green-600 mb-2">{idioma === 'val' ? "Objectiu: Estimular economia" : "Objective: Stimulate economy"}</p>
                            <ul className="text-sm space-y-1">
                                <li>‚Üì {idioma === 'val' ? "Tipus inter√®s" : "Interest rate"}</li>
                                <li>‚Üë {idioma === 'val' ? "Compra bons" : "Buy bonds"}</li>
                                <li>‚Üì {idioma === 'val' ? "Coef. reserves" : "Reserve ratio"}</li>
                            </ul>
                            <p className="mt-2 text-sm font-bold">{idioma === 'val' ? "Efecte: LM‚Üí dreta, Y‚Üë, r‚Üì" : "Effect: LM‚Üí right, Y‚Üë, r‚Üì"}</p>
                        </div>
                        <div className="bg-red-50 p-4 rounded-xl">
                            <h4 className="font-bold text-red-700 mb-3">{idioma === 'val' ? "Restrictiva" : "Contractionary"}</h4>
                            <p className="text-sm text-red-600 mb-2">{idioma === 'val' ? "Objectiu: Frenar inflaci√≥" : "Objective: Curb inflation"}</p>
                            <ul className="text-sm space-y-1">
                                <li>‚Üë {idioma === 'val' ? "Tipus inter√®s" : "Interest rate"}</li>
                                <li>‚Üì {idioma === 'val' ? "Venda bons" : "Sell bonds"}</li>
                                <li>‚Üë {idioma === 'val' ? "Coef. reserves" : "Reserve ratio"}</li>
                            </ul>
                            <p className="mt-2 text-sm font-bold">{idioma === 'val' ? "Efecte: LM‚Üê esquerra, Y‚Üì, r‚Üë" : "Effect: LM‚Üê left, Y‚Üì, r‚Üë"}</p>
                        </div>
                    </div>
                </Card>
            </div>
        );
    };

    // ========================================================================
    // SECTION: COMER√á INTERNACIONAL
    // ========================================================================
    const ComercInternacional = () => {
        const [tab, setTab] = useState('avantatge');
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Comer√ß Internacional' : idioma === 'es' ? 'Comercio Internacional' : 'International Trade'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'avantatge', label: idioma === 'val' ? 'üìä Avantatge Comparatiu' : 'Comparative Advantage' },
                    { id: 'aranzels', label: idioma === 'val' ? 'üöß Aranzels' : 'Tariffs' },
                    { id: 'canvi', label: idioma === 'val' ? 'üí± Tipus de Canvi' : 'Exchange Rates' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'avantatge' && (
                    <Card title={idioma === 'val' ? "üìä Avantatge Comparatiu (Ricardo)" : "üìä Comparative Advantage (Ricardo)"} icon="üìä">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Avantatge Absolut" : "Absolute Advantage"} color="blue">
                                    <p>{idioma === 'val' ? "Produir amb MENYS recursos que un altre pa√≠s." : "Produce with FEWER resources than another country."}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Avantatge Comparatiu" : "Comparative Advantage"} color="green">
                                    <p>{idioma === 'val' ? "Produir amb MENOR COST D'OPORTUNITAT. Determina especialitzaci√≥!" : "Produce with LOWER OPPORTUNITY COST. Determines specialization!"}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Principi de Ricardo" : "Ricardo's Principle"} color="pink">
                                    <p>{idioma === 'val' ? "Tots els pa√Øsos guanyen del comer√ß si s'especialitzen segons avantatge comparatiu, fins i tot si un t√© avantatge absolut en tot!" : "All countries gain from trade if they specialize according to comparative advantage, even if one has absolute advantage in everything!"}</p>
                                </ConceptBox>
                            </div>
                            <div className="bg-amber-50 p-4 rounded-xl">
                                <h4 className="font-bold text-amber-800 mb-3">{idioma === 'val' ? "Exemple Cl√†ssic" : "Classic Example"}</h4>
                                <table className="w-full text-sm mb-4">
                                    <thead><tr className="border-b"><th></th><th>{idioma === 'val' ? 'Vi' : 'Wine'}</th><th>{idioma === 'val' ? 'Roba' : 'Cloth'}</th></tr></thead>
                                    <tbody>
                                        <tr><td>Portugal</td><td className="text-center">80h</td><td className="text-center">90h</td></tr>
                                        <tr><td>Anglaterra</td><td className="text-center">120h</td><td className="text-center">100h</td></tr>
                                    </tbody>
                                </table>
                                <p className="text-sm text-amber-700">{idioma === 'val' ? "Portugal: avantatge absolut en tot. Per√≤ avantatge comparatiu en vi (80/90 < 120/100). Anglaterra: av. comp. en roba." : "Portugal: absolute advantage in all. But comparative advantage in wine (80/90 < 120/100). England: comp. adv. in cloth."}</p>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'aranzels' && (
                    <Card title={idioma === 'val' ? "üöß Aranzels i Proteccionisme" : "üöß Tariffs and Protectionism"} icon="üöß">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Efectes Aranzel" : "Tariff Effects"} color="red">
                                    <ul className="space-y-1">
                                        <li>‚Üë {idioma === 'val' ? "Preu dom√®stic" : "Domestic price"}</li>
                                        <li>‚Üì {idioma === 'val' ? "Importacions" : "Imports"}</li>
                                        <li>‚Üë {idioma === 'val' ? "Producci√≥ dom√®stica" : "Domestic production"}</li>
                                        <li>‚Üì {idioma === 'val' ? "Consum" : "Consumption"}</li>
                                        <li>‚Üë {idioma === 'val' ? "Recaptaci√≥ govern" : "Government revenue"}</li>
                                        <li>‚ö†Ô∏è DWL ({idioma === 'val' ? "p√®rdua efici√®ncia" : "deadweight loss"})</li>
                                    </ul>
                                </ConceptBox>
                            </div>
                            <div>
                                <h4 className="font-bold mb-3">{idioma === 'val' ? "Arguments Proteccionistes" : "Protectionist Arguments"}</h4>
                                <div className="space-y-2 text-sm">
                                    <div className="p-2 bg-amber-50 rounded">{idioma === 'val' ? "Ind√∫stria naixent" : "Infant industry"}</div>
                                    <div className="p-2 bg-amber-50 rounded">{idioma === 'val' ? "Seguretat nacional" : "National security"}</div>
                                    <div className="p-2 bg-amber-50 rounded">{idioma === 'val' ? "Protegir llocs de treball" : "Protect jobs"}</div>
                                    <div className="p-2 bg-amber-50 rounded">{idioma === 'val' ? "Compet√®ncia deslleial (dumping)" : "Unfair competition (dumping)"}</div>
                                </div>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'canvi' && (
                    <Card title={idioma === 'val' ? "üí± Tipus de Canvi" : "üí± Exchange Rates"} icon="üí±">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Tipus Nominal" : "Nominal Exchange Rate"} color="blue">
                                    <p>{idioma === 'val' ? "Preu d'una moneda en termes d'una altra. Ex: 1‚Ç¨ = 1.10$" : "Price of one currency in terms of another. Ex: 1‚Ç¨ = 1.10$"}</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Tipus Real" : "Real Exchange Rate"} color="green">
                                    <FormulaBox formula="e = E √ó (P/P*)" desc={idioma === 'val' ? "Ajustat per nivells de preus" : "Adjusted for price levels"} />
                                </ConceptBox>
                            </div>
                            <div>
                                <h4 className="font-bold mb-3">{idioma === 'val' ? "Sistemes Canviaris" : "Exchange Rate Systems"}</h4>
                                <div className="space-y-2">
                                    <div className="p-3 bg-blue-50 rounded-xl">
                                        <strong>{idioma === 'val' ? "Flexible:" : "Floating:"}</strong> {idioma === 'val' ? "Determinat per mercat" : "Market determined"}
                                    </div>
                                    <div className="p-3 bg-green-50 rounded-xl">
                                        <strong>{idioma === 'val' ? "Fix:" : "Fixed:"}</strong> {idioma === 'val' ? "Banc Central interv√©" : "Central Bank intervenes"}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================

    // ========================================================================
    // SECTION: TEORIA DE JOCS (AMPLIADA)
    // ========================================================================
    const TeoriaJocs = () => {
        const [tab, setTab] = useState('presoner');
        const [joc, setJoc] = useState('presoner');
        
        // Jocs cl√†ssics amb payoffs
        const jocs = {
            presoner: { nom: idioma === 'val' ? "Dilema del Presoner" : "Prisoner's Dilemma", payoffs: [[3,3], [0,5], [5,0], [1,1]], est1: [idioma === 'val' ? 'Cooperar' : 'Cooperate', idioma === 'val' ? 'Confessar' : 'Confess'], est2: [idioma === 'val' ? 'Cooperar' : 'Cooperate', idioma === 'val' ? 'Confessar' : 'Confess'], nash: [1,1], pareto: [0,0] },
            sexes: { nom: idioma === 'val' ? "Batalla dels Sexes" : "Battle of the Sexes", payoffs: [[3,2], [0,0], [0,0], [2,3]], est1: [idioma === 'val' ? 'Futbol' : 'Football', idioma === 'val' ? '√ípera' : 'Opera'], est2: [idioma === 'val' ? 'Futbol' : 'Football', idioma === 'val' ? '√ípera' : 'Opera'], nash: [[0,0], [1,1]], pareto: [[0,0], [1,1]] },
            chicken: { nom: "Chicken", payoffs: [[0,0], [-1,1], [1,-1], [-10,-10]], est1: [idioma === 'val' ? 'Recte' : 'Straight', idioma === 'val' ? 'Girar' : 'Swerve'], est2: [idioma === 'val' ? 'Recte' : 'Straight', idioma === 'val' ? 'Girar' : 'Swerve'], nash: [[0,1], [1,0]], pareto: [[0,1], [1,0]] },
            coordinacio: { nom: idioma === 'val' ? "Coordinaci√≥" : "Coordination", payoffs: [[2,2], [0,0], [0,0], [1,1]], est1: ['A', 'B'], est2: ['A', 'B'], nash: [[0,0], [1,1]], pareto: [0,0] },
        };
        
        const jocActual = jocs[joc];
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Teoria de Jocs' : idioma === 'es' ? 'Teor√≠a de Juegos' : 'Game Theory'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'presoner', label: idioma === 'val' ? 'üéÆ Jocs Cl√†ssics' : 'üéÆ Classic Games' },
                    { id: 'mixtes', label: idioma === 'val' ? 'üé≤ Estrat√®gies Mixtes' : 'üé≤ Mixed Strategies' },
                    { id: 'sequencial', label: idioma === 'val' ? 'üå≥ Jocs Seq√ºencials' : 'üå≥ Sequential Games' },
                    { id: 'aplicacions', label: idioma === 'val' ? 'üíº Aplicacions' : 'üíº Applications' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'presoner' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üéÆ Simulador de Jocs" : "üéÆ Game Simulator"} icon="üéÆ">
                            <div className="flex flex-wrap gap-2 mb-4">
                                {Object.entries(jocs).map(([k, v]) => (
                                    <button key={k} onClick={() => setJoc(k)} className={`px-4 py-2 rounded-lg font-medium ${joc === k ? 'bg-pink-500 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}>{v.nom}</button>
                                ))}
                            </div>
                            
                            <div className="grid md:grid-cols-2 gap-6">
                                <div>
                                    <h4 className="font-bold text-gray-800 mb-3">{idioma === 'val' ? 'Matriu de Pagaments' : 'Payoff Matrix'}</h4>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm border">
                                            <thead>
                                                <tr><th className="border p-2 bg-gray-100"></th><th className="border p-2 bg-gray-100"></th><th className="border p-2 bg-blue-100" colSpan="2">{idioma === 'val' ? 'Jugador 2' : 'Player 2'}</th></tr>
                                                <tr><th className="border p-2 bg-gray-100"></th><th className="border p-2 bg-gray-100"></th><th className="border p-2 bg-blue-50">{jocActual.est2[0]}</th><th className="border p-2 bg-blue-50">{jocActual.est2[1]}</th></tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td className="border p-2 bg-pink-100 font-bold" rowSpan="2">{idioma === 'val' ? 'Jugador 1' : 'Player 1'}</td>
                                                    <td className="border p-2 bg-pink-50">{jocActual.est1[0]}</td>
                                                    <td className={`border p-2 text-center ${JSON.stringify(jocActual.nash).includes('[0,0]') ? 'bg-amber-100 font-bold' : ''}`}>{jocActual.payoffs[0][0]}, {jocActual.payoffs[0][1]}</td>
                                                    <td className={`border p-2 text-center ${JSON.stringify(jocActual.nash).includes('[0,1]') ? 'bg-amber-100 font-bold' : ''}`}>{jocActual.payoffs[1][0]}, {jocActual.payoffs[1][1]}</td>
                                                </tr>
                                                <tr>
                                                    <td className="border p-2 bg-pink-50">{jocActual.est1[1]}</td>
                                                    <td className={`border p-2 text-center ${JSON.stringify(jocActual.nash).includes('[1,0]') ? 'bg-amber-100 font-bold' : ''}`}>{jocActual.payoffs[2][0]}, {jocActual.payoffs[2][1]}</td>
                                                    <td className={`border p-2 text-center ${JSON.stringify(jocActual.nash).includes('[1,1]') ? 'bg-amber-100 font-bold' : ''}`}>{jocActual.payoffs[3][0]}, {jocActual.payoffs[3][1]}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <p className="text-xs text-gray-500 mt-2">* {idioma === 'val' ? 'Cel¬∑les grogues = Equilibri Nash' : 'Yellow cells = Nash Equilibrium'}</p>
                                </div>
                                <div>
                                    <ConceptBox title={idioma === 'val' ? "Equilibri de Nash" : "Nash Equilibrium"} color="amber">
                                        <p>{idioma === 'val' ? "Cap jugador pot millorar canviant UNILATERALMENT d'estrat√®gia. √âs autoconfirmatori." : "No player can improve by UNILATERALLY changing strategy. It is self-enforcing."}</p>
                                        <FormulaBox formula="s* : u·µ¢(s·µ¢*, s‚Çã·µ¢*) ‚â• u·µ¢(s·µ¢, s‚Çã·µ¢*) ‚àÄs·µ¢" />
                                    </ConceptBox>
                                    <ConceptBox title={idioma === 'val' ? "Estrat√®gia Dominant" : "Dominant Strategy"} color="pink">
                                        <p>{idioma === 'val' ? "Millor resposta independentment del que faci l'altre." : "Best response regardless of what the other does."}</p>
                                        <p className="text-sm mt-2">{idioma === 'val' ? "En el Dilema del Presoner: Confessar domina Cooperar per ambd√≥s" : "In Prisoner's Dilemma: Confess dominates Cooperate for both"}</p>
                                    </ConceptBox>
                                    <ConceptBox title={idioma === 'val' ? "√íptim de Pareto" : "Pareto Optimum"} color="green">
                                        <p>{idioma === 'val' ? "No es pot millorar un jugador sense empitjorar l'altre." : "Cannot make one better off without making another worse off."}</p>
                                    </ConceptBox>
                                </div>
                            </div>
                        </Card>
                        
                        <Card title={idioma === 'val' ? "üìö Conceptes Fonamentals" : "üìö Fundamental Concepts"} icon="üìö">
                            <div className="grid md:grid-cols-3 gap-4">
                                <div className="p-4 bg-blue-50 rounded-xl">
                                    <h4 className="font-bold text-blue-700 mb-2">{idioma === 'val' ? "Millor Resposta" : "Best Response"}</h4>
                                    <p className="text-sm text-blue-600">{idioma === 'val' ? "L'estrat√®gia que maximitza el payoff donat el que fan els altres." : "Strategy that maximizes payoff given what others do."}</p>
                                    <FormulaBox formula="BR·µ¢(s‚Çã·µ¢) = argmax u·µ¢(s·µ¢, s‚Çã·µ¢)" />
                                </div>
                                <div className="p-4 bg-green-50 rounded-xl">
                                    <h4 className="font-bold text-green-700 mb-2">{idioma === 'val' ? "Domin√†ncia Estricta" : "Strict Dominance"}</h4>
                                    <p className="text-sm text-green-600">{idioma === 'val' ? "s·µ¢ domina estrictament s·µ¢' si d√≥na SEMPRE m√©s payoff." : "s·µ¢ strictly dominates s·µ¢' if it ALWAYS gives more payoff."}</p>
                                </div>
                                <div className="p-4 bg-violet-50 rounded-xl">
                                    <h4 className="font-bold text-violet-700 mb-2">{idioma === 'val' ? "IESDS" : "IESDS"}</h4>
                                    <p className="text-sm text-violet-600">{idioma === 'val' ? "Eliminaci√≥ Iterativa d'Estrat√®gies Estrictament Dominades" : "Iterated Elimination of Strictly Dominated Strategies"}</p>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'mixtes' && (
                    <Card title={idioma === 'val' ? "üé≤ Estrat√®gies Mixtes" : "üé≤ Mixed Strategies"} icon="üé≤">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <p className="text-gray-700 mb-4">{idioma === 'val' ? "Quan no hi ha Nash en estrat√®gies pures, els jugadors poden aleatoritzar." : "When there's no Nash in pure strategies, players can randomize."}</p>
                                
                                <ConceptBox title={idioma === 'val' ? "Definici√≥" : "Definition"} color="blue">
                                    <p>{idioma === 'val' ? "Una estrat√®gia mixta √©s una distribuci√≥ de probabilitat sobre les estrat√®gies pures." : "A mixed strategy is a probability distribution over pure strategies."}</p>
                                    <FormulaBox formula="œÉ·µ¢ ‚àà Œî(S·µ¢)" desc={idioma === 'val' ? "œÉ·µ¢ pertany al s√≠mplex de probabilitats" : "œÉ·µ¢ belongs to probability simplex"} />
                                </ConceptBox>
                                
                                <ConceptBox title={idioma === 'val' ? "C√†lcul de l'Equilibri Mixt" : "Computing Mixed Equilibrium"} color="green">
                                    <p className="text-sm">{idioma === 'val' ? "Cada jugador tria probabilitats que fan l'altre INDIFERENT entre les seves opcions." : "Each player chooses probabilities that make the other INDIFFERENT between their options."}</p>
                                    <FormulaBox formula="E[u‚ÇÅ|s‚ÇÇ=A] = E[u‚ÇÅ|s‚ÇÇ=B]" />
                                </ConceptBox>
                            </div>
                            <div>
                                <h4 className="font-bold text-gray-800 mb-3">{idioma === 'val' ? "Exemple: Matching Pennies" : "Example: Matching Pennies"}</h4>
                                <table className="w-full text-sm border mb-4">
                                    <thead>
                                        <tr><th className="border p-2"></th><th className="border p-2">{idioma === 'val' ? 'Cara' : 'Heads'}</th><th className="border p-2">{idioma === 'val' ? 'Creu' : 'Tails'}</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr><td className="border p-2 font-bold">{idioma === 'val' ? 'Cara' : 'Heads'}</td><td className="border p-2 text-center">1, -1</td><td className="border p-2 text-center">-1, 1</td></tr>
                                        <tr><td className="border p-2 font-bold">{idioma === 'val' ? 'Creu' : 'Tails'}</td><td className="border p-2 text-center">-1, 1</td><td className="border p-2 text-center">1, -1</td></tr>
                                    </tbody>
                                </table>
                                <div className="p-4 bg-amber-100 rounded-xl text-center">
                                    <p className="font-bold text-amber-800">{idioma === 'val' ? 'Nash Mixt:' : 'Mixed Nash:'}</p>
                                    <p className="text-amber-700">œÉ‚ÇÅ = œÉ‚ÇÇ = (0.5, 0.5)</p>
                                    <p className="text-sm text-amber-600">{idioma === 'val' ? 'Cada jugador tria 50% cada opci√≥' : 'Each player picks 50% each option'}</p>
                                </div>
                                
                                <ConceptBox title={idioma === 'val' ? "Teorema de Nash (1950)" : "Nash Theorem (1950)"} color="pink">
                                    <p className="text-sm">{idioma === 'val' ? "Tot joc finit t√© almenys un equilibri de Nash (en estrat√®gies pures o mixtes)." : "Every finite game has at least one Nash equilibrium (in pure or mixed strategies)."}</p>
                                </ConceptBox>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'sequencial' && (
                    <Card title={idioma === 'val' ? "üå≥ Jocs Seq√ºencials i Arbres de Joc" : "üå≥ Sequential Games and Game Trees"} icon="üå≥">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 className="font-bold text-gray-800 mb-3">{idioma === 'val' ? "Joc d'Entrada al Mercat" : "Market Entry Game"}</h4>
                                <div className="bg-gray-50 p-4 rounded-xl font-mono text-sm">
                                    <pre className="text-center">{`
         Entrant
        /      \\
     Entrar   No Entrar
      /           \\
  Incumbent      (0, 2)
   /     \\
Lluitar  Acomodar
 /          \\
(-1,-1)    (1, 1)
                    `}</pre>
                                </div>
                                
                                <ConceptBox title={idioma === 'val' ? "Inducci√≥ cap Enrere" : "Backward Induction"} color="blue">
                                    <p className="text-sm">{idioma === 'val' ? "Resoldre des del final cap al principi. Trobar l'acci√≥ √≤ptima a cada node." : "Solve from end to beginning. Find optimal action at each node."}</p>
                                    <ol className="text-sm mt-2 space-y-1">
                                        <li>1. {idioma === 'val' ? "Incumbent: Acomodar (1 > -1)" : "Incumbent: Accommodate (1 > -1)"}</li>
                                        <li>2. {idioma === 'val' ? "Entrant: Entrar (1 > 0)" : "Entrant: Enter (1 > 0)"}</li>
                                    </ol>
                                </ConceptBox>
                            </div>
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Equilibri Perfecte en Subjocs (SPE)" : "Subgame Perfect Equilibrium (SPE)"} color="green">
                                    <p>{idioma === 'val' ? "Estrat√®gies que formen Nash a CADA subjoc (inclosos els que no es juguen)." : "Strategies that form Nash at EVERY subgame (including off-path ones)."}</p>
                                    <p className="text-sm mt-2 font-bold">{idioma === 'val' ? "Elimina amenaces no cre√Øbles" : "Eliminates non-credible threats"}</p>
                                </ConceptBox>
                                
                                <ConceptBox title={idioma === 'val' ? "Comprom√≠s i Credibilitat" : "Commitment and Credibility"} color="amber">
                                    <p className="text-sm">{idioma === 'val' ? "L'incumbent pot amena√ßar amb lluitar, per√≤ NO √©s cre√Øble perqu√® lluitar li dona -1." : "Incumbent can threaten to fight, but it's NOT credible because fighting gives -1."}</p>
                                    <p className="text-sm mt-2">{idioma === 'val' ? "Per fer l'amena√ßa cre√Øble: invertir en capacitat, contractes, reputaci√≥..." : "To make threat credible: invest in capacity, contracts, reputation..."}</p>
                                </ConceptBox>
                                
                                <div className="p-4 bg-violet-50 rounded-xl mt-4">
                                    <h4 className="font-bold text-violet-700 mb-2">{idioma === 'val' ? "First-Mover Advantage" : "First-Mover Advantage"}</h4>
                                    <p className="text-sm text-violet-600">{idioma === 'val' ? "En Stackelberg, el l√≠der guanya m√©s que en Cournot perqu√® pot 'comprometre's' a una quantitat alta." : "In Stackelberg, leader earns more than in Cournot because they can 'commit' to high quantity."}</p>
                                </div>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'aplicacions' && (
                    <Card title={idioma === 'val' ? "üíº Aplicacions Econ√≤miques" : "üíº Economic Applications"} icon="üíº">
                        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div className="p-4 bg-blue-50 rounded-xl">
                                <h4 className="font-bold text-blue-700 mb-2">üè¢ {idioma === 'val' ? "Oligopoli" : "Oligopoly"}</h4>
                                <ul className="text-sm text-blue-600 space-y-1">
                                    <li>‚Ä¢ <strong>Cournot:</strong> {idioma === 'val' ? "Compet√®ncia en quantitats (simult√†nia)" : "Quantity competition (simultaneous)"}</li>
                                    <li>‚Ä¢ <strong>Bertrand:</strong> {idioma === 'val' ? "Compet√®ncia en preus" : "Price competition"}</li>
                                    <li>‚Ä¢ <strong>Stackelberg:</strong> {idioma === 'val' ? "L√≠der-seguidor" : "Leader-follower"}</li>
                                </ul>
                            </div>
                            <div className="p-4 bg-green-50 rounded-xl">
                                <h4 className="font-bold text-green-700 mb-2">ü§ù {idioma === 'val' ? "Negociaci√≥" : "Bargaining"}</h4>
                                <ul className="text-sm text-green-600 space-y-1">
                                    <li>‚Ä¢ {idioma === 'val' ? "Model de Rubinstein" : "Rubinstein model"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Ultim√†tum" : "Ultimatum game"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Soluci√≥ de Nash" : "Nash bargaining solution"}</li>
                                </ul>
                            </div>
                            <div className="p-4 bg-amber-50 rounded-xl">
                                <h4 className="font-bold text-amber-700 mb-2">üìú {idioma === 'val' ? "Subhastes" : "Auctions"}</h4>
                                <ul className="text-sm text-amber-600 space-y-1">
                                    <li>‚Ä¢ {idioma === 'val' ? "Anglesa (ascendent)" : "English (ascending)"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Holandesa (descendent)" : "Dutch (descending)"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Sobre tancat" : "Sealed bid"}</li>
                                    <li>‚Ä¢ {idioma === 'val' ? "Vickrey (segon preu)" : "Vickrey (second price)"}</li>
                                </ul>
                            </div>
                            <div className="p-4 bg-pink-50 rounded-xl">
                                <h4 className="font-bold text-pink-700 mb-2">üìä {idioma === 'val' ? "Senyalitzaci√≥" : "Signaling"}</h4>
                                <p className="text-sm text-pink-600">{idioma === 'val' ? "Educaci√≥ com a senyal de productivitat (Spence)" : "Education as productivity signal (Spence)"}</p>
                            </div>
                            <div className="p-4 bg-violet-50 rounded-xl">
                                <h4 className="font-bold text-violet-700 mb-2">üèõÔ∏è {idioma === 'val' ? "Votaci√≥" : "Voting"}</h4>
                                <p className="text-sm text-violet-600">{idioma === 'val' ? "Vot estrat√®gic, teorema de l'elector medi√†" : "Strategic voting, median voter theorem"}</p>
                            </div>
                            <div className="p-4 bg-cyan-50 rounded-xl">
                                <h4 className="font-bold text-cyan-700 mb-2">üåç {idioma === 'val' ? "B√©ns P√∫blics" : "Public Goods"}</h4>
                                <p className="text-sm text-cyan-600">{idioma === 'val' ? "Free-rider problem com a dilema presoner de n jugadors" : "Free-rider problem as n-player prisoner's dilemma"}</p>
                            </div>
                        </div>
                        
                        <div className="mt-6 p-4 bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl text-white">
                            <h4 className="font-bold mb-2">{idioma === 'val' ? "Jocs Repetits i Cooperaci√≥" : "Repeated Games and Cooperation"}</h4>
                            <p className="text-sm text-white/90">{idioma === 'val' ? "En jocs repetits infinitament, la cooperaci√≥ pot ser sostinguda com a equilibri Nash (Folk Theorem). Estrat√®gies: Tit-for-Tat, Grim Trigger." : "In infinitely repeated games, cooperation can be sustained as Nash equilibrium (Folk Theorem). Strategies: Tit-for-Tat, Grim Trigger."}</p>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: HIST√íRIA ECON√íMICA (AMPLIADA)
    // ========================================================================
    const HistoriaEconomica = () => {
        const [tab, setTab] = useState('economistes');
        
        const economistes = [
            { nom: "Adam Smith", any: "1723-1790", escola: idioma === 'val' ? "Cl√†ssica" : "Classical", idea: idioma === 'val' ? "M√† invisible, divisi√≥ del treball, lliure mercat, valor-treball" : "Invisible hand, division of labor, free market, labor value", obra: "The Wealth of Nations (1776)", color: "blue" },
            { nom: "David Ricardo", any: "1772-1823", escola: idioma === 'val' ? "Cl√†ssica" : "Classical", idea: idioma === 'val' ? "Avantatge comparatiu, teoria del valor-treball, renda diferencial" : "Comparative advantage, labor theory of value, differential rent", obra: "Principles of Political Economy (1817)", color: "blue" },
            { nom: "John Stuart Mill", any: "1806-1873", escola: idioma === 'val' ? "Cl√†ssica" : "Classical", idea: idioma === 'val' ? "Utilitarisme, economia del benestar, liberalisme" : "Utilitarianism, welfare economics, liberalism", obra: "Principles of Political Economy (1848)", color: "blue" },
            { nom: "Karl Marx", any: "1818-1883", escola: idioma === 'val' ? "Marxista" : "Marxist", idea: idioma === 'val' ? "Plusv√†lua, lluita de classes, materialisme hist√≤ric, crisi capitalisme" : "Surplus value, class struggle, historical materialism, capitalism crisis", obra: "Das Kapital (1867)", color: "red" },
            { nom: "Carl Menger", any: "1840-1921", escola: idioma === 'val' ? "Austr√≠aca" : "Austrian", idea: idioma === 'val' ? "Utilitat marginal subjectiva, individualisme metodol√≤gic" : "Subjective marginal utility, methodological individualism", obra: "Principles of Economics (1871)", color: "amber" },
            { nom: "Alfred Marshall", any: "1842-1924", escola: idioma === 'val' ? "Neocl√†ssica" : "Neoclassical", idea: idioma === 'val' ? "Oferta i demanda, equilibri parcial, elasticitat, excedents" : "Supply and demand, partial equilibrium, elasticity, surplus", obra: "Principles of Economics (1890)", color: "green" },
            { nom: "L√©on Walras", any: "1834-1910", escola: idioma === 'val' ? "Neocl√†ssica" : "Neoclassical", idea: idioma === 'val' ? "Equilibri general, subhastador walrasi√†" : "General equilibrium, Walrasian auctioneer", obra: "Elements of Pure Economics (1874)", color: "green" },
            { nom: "Vilfredo Pareto", any: "1848-1923", escola: idioma === 'val' ? "Neocl√†ssica" : "Neoclassical", idea: idioma === 'val' ? "Efici√®ncia de Pareto, corbes indifer√®ncia, distribuci√≥ Pareto" : "Pareto efficiency, indifference curves, Pareto distribution", obra: "Manual of Political Economy (1906)", color: "green" },
            { nom: "Joseph Schumpeter", any: "1883-1950", escola: idioma === 'val' ? "Evolucionista" : "Evolutionary", idea: idioma === 'val' ? "Destrucci√≥ creativa, innovaci√≥, emprenedor, cicles econ√≤mics" : "Creative destruction, innovation, entrepreneur, business cycles", obra: "Capitalism, Socialism & Democracy (1942)", color: "violet" },
            { nom: "John M. Keynes", any: "1883-1946", escola: "Keynesiana", idea: idioma === 'val' ? "Demanda agregada, multiplicador, prefer√®ncia liquiditat, intervenci√≥ estatal" : "Aggregate demand, multiplier, liquidity preference, state intervention", obra: "General Theory (1936)", color: "pink" },
            { nom: "Friedrich Hayek", any: "1899-1992", escola: idioma === 'val' ? "Austr√≠aca" : "Austrian", idea: idioma === 'val' ? "Coneixement dispers, ordre espontani, cr√≠tica planificaci√≥ central" : "Dispersed knowledge, spontaneous order, central planning critique", obra: "The Road to Serfdom (1944)", color: "amber" },
            { nom: "Milton Friedman", any: "1912-2006", escola: "Monetarista", idea: idioma === 'val' ? "Quantitat de diners, expectatives adaptatives, taxa natural atur" : "Quantity of money, adaptive expectations, natural rate unemployment", obra: "A Monetary History (1963)", color: "indigo" },
            { nom: "Paul Samuelson", any: "1915-2009", escola: idioma === 'val' ? "S√≠ntesi Neocl√†ssica" : "Neoclassical Synthesis", idea: idioma === 'val' ? "Economia matem√†tica, revealed preferences, model Samuelson-Solow" : "Mathematical economics, revealed preferences, Samuelson-Solow model", obra: "Foundations of Economic Analysis (1947)", color: "teal" },
            { nom: "Kenneth Arrow", any: "1921-2017", escola: idioma === 'val' ? "Equilibri General" : "General Equilibrium", idea: idioma === 'val' ? "Teorema impossibilitat, Arrow-Debreu, incertesa" : "Impossibility theorem, Arrow-Debreu, uncertainty", obra: "Social Choice and Individual Values (1951)", color: "cyan" },
            { nom: "Robert Lucas", any: "1937-2023", escola: idioma === 'val' ? "Nous Cl√†ssics" : "New Classical", idea: idioma === 'val' ? "Expectatives racionals, cr√≠tica de Lucas, microfundaments" : "Rational expectations, Lucas critique, microfoundations", obra: "Studies in Business-Cycle Theory (1981)", color: "slate" },
        ];
        
        const escoles = [
            { nom: idioma === 'val' ? "Cl√†ssica" : "Classical", periode: "1770-1870", autors: "Smith, Ricardo, Mill, Say", idees: idioma === 'val' ? "Lliure mercat, valor-treball, llei de Say, creixement" : "Free market, labor value, Say's law, growth", color: "blue" },
            { nom: idioma === 'val' ? "Marxista" : "Marxist", periode: "1867-", autors: "Marx, Engels, Lenin", idees: idioma === 'val' ? "Plusv√†lua, explotaci√≥, lluita de classes, caiguda capitalisme" : "Surplus value, exploitation, class struggle, capitalism's fall", color: "red" },
            { nom: idioma === 'val' ? "Marginalista/Neocl√†ssica" : "Marginalist/Neoclassical", periode: "1870-1930", autors: "Menger, Jevons, Walras, Marshall", idees: idioma === 'val' ? "Utilitat marginal, equilibri, optimitzaci√≥, homo economicus" : "Marginal utility, equilibrium, optimization, homo economicus", color: "green" },
            { nom: idioma === 'val' ? "Austr√≠aca" : "Austrian", periode: "1871-", autors: "Menger, Mises, Hayek", idees: idioma === 'val' ? "Subjectivisme, praxeologia, ordre espontani, anticentralisme" : "Subjectivism, praxeology, spontaneous order, anti-centralism", color: "amber" },
            { nom: "Keynesiana", periode: "1936-", autors: "Keynes, Hicks, Hansen", idees: idioma === 'val' ? "Demanda agregada, atur involuntari, pol√≠tica fiscal" : "Aggregate demand, involuntary unemployment, fiscal policy", color: "pink" },
            { nom: "Monetarista", periode: "1960-", autors: "Friedman, Schwartz, Brunner", idees: idioma === 'val' ? "Inflaci√≥ √©s fenomen monetari, regles vs discreci√≥" : "Inflation is monetary phenomenon, rules vs discretion", color: "indigo" },
            { nom: idioma === 'val' ? "Nous Cl√†ssics" : "New Classical", periode: "1970-", autors: "Lucas, Sargent, Barro", idees: idioma === 'val' ? "Expectatives racionals, inefic√†cia pol√≠tica, RBC" : "Rational expectations, policy ineffectiveness, RBC", color: "slate" },
            { nom: idioma === 'val' ? "Nous Keynesians" : "New Keynesian", periode: "1980-", autors: "Mankiw, Blanchard, Romer", idees: idioma === 'val' ? "Rigideses nominals, compet√®ncia imperfecta, DSGE" : "Nominal rigidities, imperfect competition, DSGE", color: "rose" },
        ];
        
        const debats = [
            { titol: idioma === 'val' ? "Keynes vs Hayek" : "Keynes vs Hayek", any: "1930s", tema: idioma === 'val' ? "Intervenci√≥ estatal vs mercat lliure durant la Gran Depressi√≥" : "State intervention vs free market during Great Depression", guanyador: idioma === 'val' ? "Keynes (en pol√≠tica), debat obert en teoria" : "Keynes (in policy), open debate in theory" },
            { titol: idioma === 'val' ? "C√†lcul Socialista" : "Socialist Calculation", any: "1920-40", tema: idioma === 'val' ? "Mises/Hayek vs Lange: Pot una economia planificada funcionar?" : "Mises/Hayek vs Lange: Can a planned economy work?", guanyador: idioma === 'val' ? "Austr√≠acs (ex post, caiguda URSS)" : "Austrians (ex post, USSR collapse)" },
            { titol: idioma === 'val' ? "Monetaristes vs Keynesians" : "Monetarists vs Keynesians", any: "1960-70s", tema: idioma === 'val' ? "Efectivitat pol√≠tica fiscal vs monet√†ria, Phillips Curve" : "Fiscal vs monetary policy effectiveness, Phillips Curve", guanyador: idioma === 'val' ? "S√≠ntesi: ambdues importen, expectatives clau" : "Synthesis: both matter, expectations key" },
            { titol: idioma === 'val' ? "Aigua Salada vs Aigua Dol√ßa" : "Saltwater vs Freshwater", any: "1980-2008", tema: idioma === 'val' ? "MIT/Harvard vs Chicago/Minnesota: rigideses, pol√≠tica" : "MIT/Harvard vs Chicago/Minnesota: rigidities, policy", guanyador: idioma === 'val' ? "Post-2008: Nous Keynesians guanyen terreny" : "Post-2008: New Keynesians gain ground" },
        ];
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Hist√≤ria del Pensament Econ√≤mic' : idioma === 'es' ? 'Historia del Pensamiento Econ√≥mico' : 'History of Economic Thought'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'economistes', label: idioma === 'val' ? 'üë§ Economistes' : 'üë§ Economists' },
                    { id: 'escoles', label: idioma === 'val' ? 'üèõÔ∏è Escoles' : 'üèõÔ∏è Schools' },
                    { id: 'timeline', label: 'üìÖ Timeline' },
                    { id: 'debats', label: idioma === 'val' ? '‚öîÔ∏è Grans Debats' : '‚öîÔ∏è Great Debates' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'economistes' && (
                    <div className="space-y-4">
                        {economistes.map((e, i) => (
                            <Card key={i} className="hover:shadow-lg transition-shadow">
                                <div className="flex flex-col md:flex-row md:items-center gap-4">
                                    <div className={`flex-shrink-0 w-16 h-16 bg-gradient-to-br from-${e.color}-400 to-${e.color}-600 rounded-full flex items-center justify-center text-white text-xl font-bold`}>
                                        {e.nom.split(' ').map(n => n[0]).join('')}
                                    </div>
                                    <div className="flex-1">
                                        <div className="flex flex-wrap items-center gap-2 mb-1">
                                            <h3 className="font-bold text-lg text-gray-800">{e.nom}</h3>
                                            <span className="text-sm text-gray-500">({e.any})</span>
                                            <span className={`px-2 py-0.5 bg-${e.color}-100 text-${e.color}-600 text-xs rounded-full`}>{e.escola}</span>
                                        </div>
                                        <p className="text-gray-700 text-sm mb-1">{e.idea}</p>
                                        <p className="text-xs text-gray-500">üìñ {e.obra}</p>
                                    </div>
                                </div>
                            </Card>
                        ))}
                    </div>
                )}
                
                {tab === 'escoles' && (
                    <div className="grid md:grid-cols-2 gap-4">
                        {escoles.map((e, i) => (
                            <div key={i} className={`p-4 bg-${e.color}-50 border-l-4 border-${e.color}-500 rounded-r-xl`}>
                                <div className="flex justify-between items-start mb-2">
                                    <h4 className={`font-bold text-${e.color}-700`}>{e.nom}</h4>
                                    <span className="text-xs text-gray-500">{e.periode}</span>
                                </div>
                                <p className="text-xs text-gray-600 mb-2"><strong>{idioma === 'val' ? 'Autors:' : 'Authors:'}</strong> {e.autors}</p>
                                <p className={`text-sm text-${e.color}-600`}>{e.idees}</p>
                            </div>
                        ))}
                    </div>
                )}
                
                {tab === 'timeline' && (
                    <Card title="üìÖ Timeline" icon="üìÖ">
                        <div className="relative">
                            <div className="absolute left-4 top-0 bottom-0 w-0.5 bg-pink-200"></div>
                            <div className="space-y-6 pl-12">
                                {[
                                    { any: 1776, event: idioma === 'val' ? "Smith: The Wealth of Nations ‚Üí Naixement economia moderna" : "Smith: The Wealth of Nations ‚Üí Birth of modern economics" },
                                    { any: 1817, event: idioma === 'val' ? "Ricardo: Avantatge comparatiu ‚Üí Base comer√ß internacional" : "Ricardo: Comparative advantage ‚Üí International trade foundation" },
                                    { any: 1867, event: idioma === 'val' ? "Marx: Das Kapital ‚Üí Cr√≠tica sistem√†tica capitalisme" : "Marx: Das Kapital ‚Üí Systematic capitalism critique" },
                                    { any: 1871, event: idioma === 'val' ? "Revoluci√≥ Marginalista (Menger, Jevons, Walras)" : "Marginalist Revolution (Menger, Jevons, Walras)" },
                                    { any: 1890, event: idioma === 'val' ? "Marshall: Oferta i demanda, equilibri parcial" : "Marshall: Supply and demand, partial equilibrium" },
                                    { any: 1936, event: idioma === 'val' ? "Keynes: General Theory ‚Üí Revoluci√≥ keynesiana" : "Keynes: General Theory ‚Üí Keynesian revolution" },
                                    { any: 1944, event: idioma === 'val' ? "Bretton Woods, Hayek: Road to Serfdom" : "Bretton Woods, Hayek: Road to Serfdom" },
                                    { any: 1963, event: idioma === 'val' ? "Friedman: Monetarisme, contrarrevoluci√≥" : "Friedman: Monetarism, counter-revolution" },
                                    { any: 1972, event: idioma === 'val' ? "Lucas: Expectatives racionals ‚Üí Nous Cl√†ssics" : "Lucas: Rational expectations ‚Üí New Classical" },
                                    { any: 2008, event: idioma === 'val' ? "Crisi financera ‚Üí Q√ºestionament models, retorn Keynes" : "Financial crisis ‚Üí Model questioning, Keynes return" },
                                ].map((item, i) => (
                                    <div key={i} className="relative">
                                        <div className="absolute -left-10 w-6 h-6 bg-pink-500 rounded-full flex items-center justify-center">
                                            <div className="w-2 h-2 bg-white rounded-full"></div>
                                        </div>
                                        <div className="bg-white p-3 rounded-lg shadow-sm border">
                                            <span className="font-bold text-pink-600">{item.any}</span>
                                            <p className="text-sm text-gray-700">{item.event}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'debats' && (
                    <div className="space-y-4">
                        {debats.map((d, i) => (
                            <Card key={i}>
                                <div className="flex items-start gap-4">
                                    <div className="text-3xl">‚öîÔ∏è</div>
                                    <div className="flex-1">
                                        <div className="flex items-center gap-2 mb-2">
                                            <h4 className="font-bold text-gray-800">{d.titol}</h4>
                                            <span className="text-sm text-gray-500">({d.any})</span>
                                        </div>
                                        <p className="text-gray-700 text-sm mb-2">{d.tema}</p>
                                        <p className="text-sm"><span className="font-bold text-pink-600">{idioma === 'val' ? 'Resultat:' : 'Result:'}</span> {d.guanyador}</p>
                                    </div>
                                </div>
                            </Card>
                        ))}
                        
                        <ConceptBox title={idioma === 'val' ? "Per qu√® importen aquests debats?" : "Why do these debates matter?"} color="pink">
                            <p>{idioma === 'val' ? "Les pol√≠tiques econ√≤miques actuals (tipus d'inter√®s, est√≠muls fiscals, regulaci√≥) reflecteixen qui 'guanya' aquests debats en cada moment. Entendre la hist√≤ria ajuda a entendre per qu√® fem el que fem." : "Current economic policies (interest rates, fiscal stimulus, regulation) reflect who 'wins' these debates at each moment. Understanding history helps understand why we do what we do."}</p>
                        </ConceptBox>
                    </div>
                )}
            </div>
        );
    };
    // ========================================================================
    // SECTION: QUIZ
    // ========================================================================
    const Quiz = () => {
        const [current, setCurrent] = useState(0);
        const [score, setScore] = useState(0);
        const [finished, setFinished] = useState(false);
        
        const preguntes = [
            { q: idioma === 'val' ? "En compet√®ncia perfecta, el benefici econ√≤mic a llarg termini √©s:" : "In perfect competition, long-run economic profit is:", opts: ["Positiu", "Negatiu", "Zero", idioma === 'val' ? "Dep√®n" : "Depends"], ans: 2 },
            { q: idioma === 'val' ? "El monopolista maximitza beneficis on:" : "The monopolist maximizes profits where:", opts: ["P = CMg", "IMg = CMg", "P = CMe", "IMg = CMe"], ans: 1 },
            { q: idioma === 'val' ? "L'equilibri Cournot-Nash t√©:" : "Cournot-Nash equilibrium has:", opts: [idioma === 'val' ? "M√©s Q que monopoli" : "More Q than monopoly", idioma === 'val' ? "Menys Q que CP" : "Less Q than PC", idioma === 'val' ? "Ambdues" : "Both", idioma === 'val' ? "Cap" : "Neither"], ans: 2 },
            { q: idioma === 'val' ? "Una externalitat negativa causa:" : "A negative externality causes:", opts: [idioma === 'val' ? "Subproducci√≥" : "Underproduction", idioma === 'val' ? "Sobreproducci√≥" : "Overproduction", idioma === 'val' ? "Producci√≥ √≤ptima" : "Optimal production", idioma === 'val' ? "Dep√®n" : "Depends"], ans: 1 },
            { q: idioma === 'val' ? "En el model IS-LM, una expansi√≥ fiscal despla√ßa:" : "In IS-LM model, fiscal expansion shifts:", opts: ["IS dreta, LM esquerra", "IS dreta, LM no canvia", "IS esquerra, LM dreta", "Nom√©s LM dreta"], ans: 1 },
        ];
        
        const handleAnswer = (idx) => {
            if (idx === preguntes[current].ans) setScore(score + 1);
            if (current < preguntes.length - 1) setCurrent(current + 1);
            else setFinished(true);
        };
        
        if (finished) {
            return (
                <Card className="text-center max-w-lg mx-auto">
                    <h2 className="text-2xl font-black text-gray-800 mb-4">{idioma === 'val' ? "Resultat" : "Result"}</h2>
                    <p className="text-5xl font-black text-pink-600 mb-4">{score}/{preguntes.length}</p>
                    <p className="text-gray-600 mb-4">
                        {score === preguntes.length ? "üéâ " + (idioma === 'val' ? "Perfecte!" : "Perfect!") :
                         score >= preguntes.length * 0.6 ? "üëç " + (idioma === 'val' ? "Molt b√©!" : "Very good!") :
                         "üìö " + (idioma === 'val' ? "Segueix estudiant!" : "Keep studying!")}
                    </p>
                    <button onClick={() => { setCurrent(0); setScore(0); setFinished(false); }} className="px-6 py-2 bg-pink-500 text-white rounded-lg font-bold hover:bg-pink-600">
                        {idioma === 'val' ? "Repetir" : "Retry"}
                    </button>
                </Card>
            );
        }
        
        return (
            <div className="space-y-6">
                <h1 className="text-3xl font-black text-gray-800">Quiz</h1>
                <Card>
                    <div className="flex justify-between text-sm text-gray-500 mb-4">
                        <span>{idioma === 'val' ? "Pregunta" : "Question"} {current + 1}/{preguntes.length}</span>
                        <span>{idioma === 'val' ? "Punts" : "Score"}: {score}</span>
                    </div>
                    <h3 className="text-xl font-bold text-gray-800 mb-6">{preguntes[current].q}</h3>
                    <div className="space-y-3">
                        {preguntes[current].opts.map((opt, i) => (
                            <button key={i} onClick={() => handleAnswer(i)} className="w-full p-4 text-left bg-gray-50 hover:bg-pink-50 rounded-xl border border-gray-200 hover:border-pink-300 transition-all">
                                {opt}
                            </button>
                        ))}
                    </div>
                </Card>
            </div>
        );
    };

    // ========================================================================
    // SECTION: ESTAD√çSTICA
    // ========================================================================
    const Estadistica = () => {
        const [tab, setTab] = useState('descriptiva');
        
        // Dades per estad√≠stica descriptiva
        const [dades, setDades] = useState("12, 15, 18, 20, 22, 25, 28, 30, 32, 35");
        
        // Distribuci√≥ Normal
        const [mu, setMu] = useState(100);
        const [sigma, setSigma] = useState(15);
        const [xVal, setXVal] = useState(115);
        
        // Test d'hip√≤tesi
        const [mitjanaM, setMitjanaM] = useState(105);
        const [mitjana0, setMitjana0] = useState(100);
        const [desvEst, setDesvEst] = useState(15);
        const [nMostra, setNMostra] = useState(30);
        const [alfa, setAlfa] = useState(0.05);
        
        const estadDescriptiva = useMemo(() => {
            const nums = dades.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
            if (nums.length === 0) return null;
            
            const n = nums.length;
            const suma = nums.reduce((a, b) => a + b, 0);
            const mitjana = suma / n;
            const sorted = [...nums].sort((a, b) => a - b);
            const mediana = n % 2 === 0 ? (sorted[n/2 - 1] + sorted[n/2]) / 2 : sorted[Math.floor(n/2)];
            const variancia = nums.reduce((acc, x) => acc + Math.pow(x - mitjana, 2), 0) / (n - 1);
            const desviacio = Math.sqrt(variancia);
            const cv = (desviacio / mitjana) * 100;
            const min = Math.min(...nums);
            const max = Math.max(...nums);
            const q1 = sorted[Math.floor(n * 0.25)];
            const q3 = sorted[Math.floor(n * 0.75)];
            
            return { n, mitjana: mitjana.toFixed(2), mediana: mediana.toFixed(2), variancia: variancia.toFixed(2), desviacio: desviacio.toFixed(2), cv: cv.toFixed(1), min, max, q1, q3, rang: max - min };
        }, [dades]);
        
        const normal = useMemo(() => {
            const z = (xVal - mu) / sigma;
            // Aproximaci√≥ funci√≥ distribuci√≥ normal est√†ndard
            const erf = (x) => {
                const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
                const sign = x < 0 ? -1 : 1;
                x = Math.abs(x);
                const t = 1 / (1 + p * x);
                const y = 1 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
                return sign * y;
            };
            const phi = (z) => 0.5 * (1 + erf(z / Math.sqrt(2)));
            const prob = phi(z);
            
            return { z: z.toFixed(3), probAcum: (prob * 100).toFixed(2), probSup: ((1 - prob) * 100).toFixed(2) };
        }, [mu, sigma, xVal]);
        
        const testHipotesi = useMemo(() => {
            const errorEst = desvEst / Math.sqrt(nMostra);
            const zCalc = (mitjanaM - mitjana0) / errorEst;
            const zCritic = alfa === 0.05 ? 1.96 : alfa === 0.01 ? 2.576 : 1.645;
            const rebutja = Math.abs(zCalc) > zCritic;
            
            return { errorEst: errorEst.toFixed(3), zCalc: zCalc.toFixed(3), zCritic: zCritic.toFixed(3), rebutja };
        }, [mitjanaM, mitjana0, desvEst, nMostra, alfa]);
        
        const dadesNormal = useMemo(() => {
            const d = [];
            for (let x = mu - 4*sigma; x <= mu + 4*sigma; x += sigma/5) {
                const y = (1 / (sigma * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
                d.push({ x: x.toFixed(0), y: y * 100 });
            }
            return d;
        }, [mu, sigma]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Estad√≠stica' : idioma === 'es' ? 'Estad√≠stica' : 'Statistics'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'descriptiva', label: idioma === 'val' ? 'üìä Descriptiva' : 'üìä Descriptive' },
                    { id: 'probabilitat', label: idioma === 'val' ? 'üé≤ Probabilitat' : 'üé≤ Probability' },
                    { id: 'inferencia', label: idioma === 'val' ? 'üî¨ Infer√®ncia' : 'üî¨ Inference' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'descriptiva' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìä Estad√≠stica Descriptiva" : "üìä Descriptive Statistics"} icon="üìä">
                            <div className="mb-4">
                                <label className="block text-sm font-medium text-gray-700 mb-2">{idioma === 'val' ? 'Introdueix dades (separades per comes):' : 'Enter data (comma-separated):'}</label>
                                <input type="text" value={dades} onChange={e => setDades(e.target.value)} className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" />
                            </div>
                            
                            {estadDescriptiva && (
                                <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3">
                                    <ResultCard title="n" value={estadDescriptiva.n} color="gray" />
                                    <ResultCard title={idioma === 'val' ? "Mitjana (xÃÑ)" : "Mean (xÃÑ)"} value={estadDescriptiva.mitjana} color="blue" />
                                    <ResultCard title={idioma === 'val' ? "Mediana" : "Median"} value={estadDescriptiva.mediana} color="green" />
                                    <ResultCard title={idioma === 'val' ? "Vari√†ncia (s¬≤)" : "Variance (s¬≤)"} value={estadDescriptiva.variancia} color="amber" />
                                    <ResultCard title={idioma === 'val' ? "Desv. T√≠pica (s)" : "Std Dev (s)"} value={estadDescriptiva.desviacio} color="violet" />
                                    <ResultCard title="CV (%)" value={estadDescriptiva.cv + "%"} color="pink" />
                                    <ResultCard title="Min" value={estadDescriptiva.min} color="gray" />
                                    <ResultCard title="Max" value={estadDescriptiva.max} color="gray" />
                                    <ResultCard title="Q1" value={estadDescriptiva.q1} color="cyan" />
                                    <ResultCard title="Q3" value={estadDescriptiva.q3} color="cyan" />
                                </div>
                            )}
                        </Card>
                        
                        <Card title={idioma === 'val' ? "üìö F√≥rmules Clau" : "üìö Key Formulas"} icon="üìö">
                            <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <ConceptBox title={idioma === 'val' ? "Mitjana" : "Mean"} color="blue">
                                    <FormulaBox formula="xÃÑ = Œ£x·µ¢ / n" />
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Vari√†ncia Mostral" : "Sample Variance"} color="amber">
                                    <FormulaBox formula="s¬≤ = Œ£(x·µ¢ - xÃÑ)¬≤ / (n-1)" />
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Coeficient Variaci√≥" : "Coefficient of Variation"} color="pink">
                                    <FormulaBox formula="CV = (s / xÃÑ) √ó 100" />
                                </ConceptBox>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'probabilitat' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üîî Distribuci√≥ Normal" : "üîî Normal Distribution"} icon="üîî">
                            <div className="grid lg:grid-cols-2 gap-6">
                                <div className="space-y-3">
                                    <Slider label="Œº (mitjana)" value={mu} onChange={setMu} min={50} max={200} />
                                    <Slider label="œÉ (desviaci√≥)" value={sigma} onChange={setSigma} min={5} max={50} />
                                    <Slider label="X" value={xVal} onChange={setXVal} min={mu - 4*sigma} max={mu + 4*sigma} />
                                    
                                    <FormulaBox formula="Z = (X - Œº) / œÉ" desc={idioma === 'val' ? "Estandarditzaci√≥" : "Standardization"} />
                                    
                                    <div className="grid grid-cols-3 gap-2">
                                        <ResultCard title="Z" value={normal.z} color="blue" />
                                        <ResultCard title="P(X ‚â§ x)" value={normal.probAcum + "%"} color="green" />
                                        <ResultCard title="P(X > x)" value={normal.probSup + "%"} color="pink" />
                                    </div>
                                </div>
                                <div>
                                    <div className="h-64">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <AreaChart data={dadesNormal}>
                                                <CartesianGrid strokeDasharray="3 3" />
                                                <XAxis dataKey="x" />
                                                <YAxis />
                                                <Tooltip />
                                                <Area type="monotone" dataKey="y" stroke="#ec4899" fill="#fce4ec" />
                                                <ReferenceLine x={xVal.toFixed(0)} stroke="#ef4444" strokeDasharray="5 5" />
                                            </AreaChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>
                            </div>
                        </Card>
                        
                        <Card title={idioma === 'val' ? "üìö Altres Distribucions" : "üìö Other Distributions"} icon="üìö">
                            <div className="grid md:grid-cols-3 gap-4">
                                <ConceptBox title="Binomial" color="blue">
                                    <FormulaBox formula="P(X=k) = C(n,k) ¬∑ p·µè ¬∑ (1-p)‚Åø‚Åª·µè" />
                                    <p className="text-sm">{idioma === 'val' ? '√àxits en n intents. E[X]=np, Var=np(1-p)' : 'Successes in n trials. E[X]=np, Var=np(1-p)'}</p>
                                </ConceptBox>
                                <ConceptBox title="Poisson" color="green">
                                    <FormulaBox formula="P(X=k) = (Œª·µè ¬∑ e‚ÅªÀ°) / k!" />
                                    <p className="text-sm">{idioma === 'val' ? 'Events rars. E[X]=Œª, Var=Œª' : 'Rare events. E[X]=Œª, Var=Œª'}</p>
                                </ConceptBox>
                                <ConceptBox title="t-Student" color="violet">
                                    <p className="text-sm">{idioma === 'val' ? 'Quan œÉ desconeguda i n<30. M√©s cues gruixudes que Normal.' : 'When œÉ unknown and n<30. Heavier tails than Normal.'}</p>
                                </ConceptBox>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'inferencia' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üî¨ Test d'Hip√≤tesi per a la Mitjana" : "üî¨ Hypothesis Test for Mean"} icon="üî¨">
                            <div className="grid lg:grid-cols-2 gap-6">
                                <div>
                                    <ConceptBox title={idioma === 'val' ? "Plantejament" : "Setup"} color="blue">
                                        <p><strong>H‚ÇÄ:</strong> Œº = Œº‚ÇÄ ({idioma === 'val' ? 'hip√≤tesi nul¬∑la' : 'null hypothesis'})</p>
                                        <p><strong>H‚ÇÅ:</strong> Œº ‚â† Œº‚ÇÄ ({idioma === 'val' ? 'hip√≤tesi alternativa bilateral' : 'two-tailed alternative'})</p>
                                    </ConceptBox>
                                    
                                    <div className="space-y-3 mt-4">
                                        <Slider label={idioma === 'val' ? "Mitjana mostral (xÃÑ)" : "Sample mean (xÃÑ)"} value={mitjanaM} onChange={setMitjanaM} min={80} max={120} />
                                        <Slider label={idioma === 'val' ? "Mitjana H‚ÇÄ (Œº‚ÇÄ)" : "H‚ÇÄ mean (Œº‚ÇÄ)"} value={mitjana0} onChange={setMitjana0} min={80} max={120} />
                                        <Slider label={idioma === 'val' ? "Desviaci√≥ (œÉ)" : "Std Dev (œÉ)"} value={desvEst} onChange={setDesvEst} min={5} max={30} />
                                        <Slider label={idioma === 'val' ? "Mida mostra (n)" : "Sample size (n)"} value={nMostra} onChange={setNMostra} min={10} max={100} />
                                        <div className="flex gap-2">
                                            <span className="text-sm text-gray-600">Œ±:</span>
                                            {[0.01, 0.05, 0.10].map(a => (
                                                <button key={a} onClick={() => setAlfa(a)} className={`px-3 py-1 rounded ${alfa === a ? 'bg-pink-500 text-white' : 'bg-gray-200'}`}>{a}</button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <FormulaBox formula="Z = (xÃÑ - Œº‚ÇÄ) / (œÉ/‚àön)" desc={idioma === 'val' ? "Estad√≠stic de prova" : "Test statistic"} />
                                    
                                    <div className="grid grid-cols-2 gap-3 mt-4">
                                        <ResultCard title={idioma === 'val' ? "Error Est√†ndard" : "Std Error"} value={testHipotesi.errorEst} color="gray" />
                                        <ResultCard title="Z calculat" value={testHipotesi.zCalc} color="blue" />
                                        <ResultCard title={`Z cr√≠tic (Œ±=${alfa})`} value={"¬±" + testHipotesi.zCritic} color="amber" />
                                        <div className={`p-3 ${testHipotesi.rebutja ? 'bg-red-100 border-red-300' : 'bg-green-100 border-green-300'} border rounded-xl text-center`}>
                                            <p className="text-xs">{idioma === 'val' ? 'Decisi√≥' : 'Decision'}</p>
                                            <p className={`font-black ${testHipotesi.rebutja ? 'text-red-600' : 'text-green-600'}`}>
                                                {testHipotesi.rebutja ? (idioma === 'val' ? 'REBUTJAR H‚ÇÄ' : 'REJECT H‚ÇÄ') : (idioma === 'val' ? 'NO REBUTJAR H‚ÇÄ' : 'DO NOT REJECT H‚ÇÄ')}
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <ConceptBox title={idioma === 'val' ? "Interval de Confian√ßa" : "Confidence Interval"} color="green">
                                        <FormulaBox formula="IC = xÃÑ ¬± ZŒ±/2 ¬∑ (œÉ/‚àön)" />
                                        <p className="text-sm text-center mt-2">
                                            IC{(100*(1-alfa))}%: [{(mitjanaM - testHipotesi.zCritic * testHipotesi.errorEst).toFixed(2)}, {(mitjanaM + parseFloat(testHipotesi.zCritic) * parseFloat(testHipotesi.errorEst)).toFixed(2)}]
                                        </p>
                                    </ConceptBox>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: MATEM√ÄTIQUES PER A ECONOMIA I FINANCES
    // ========================================================================
    const Matematiques = () => {
        const [tab, setTab] = useState('derivades');
        
        // Optimitzaci√≥
        const [funcA, setFuncA] = useState(-2);
        const [funcB, setFuncB] = useState(100);
        const [funcC, setFuncC] = useState(0);
        
        // Finances
        const [capital, setCapital] = useState(10000);
        const [taxa, setTaxa] = useState(5);
        const [anys, setAnys] = useState(10);
        const [anualitat, setAnualitat] = useState(1000);
        
        // Integrals
        const [pA, setPA] = useState(50);
        const [pB, setPB] = useState(1);
        const [pEq, setPEq] = useState(20);
        
        const optimitzacio = useMemo(() => {
            // f(x) = ax¬≤ + bx + c
            // f'(x) = 2ax + b = 0 => x* = -b/(2a)
            const xOpt = -funcB / (2 * funcA);
            const yOpt = funcA * xOpt * xOpt + funcB * xOpt + funcC;
            const esMaxim = funcA < 0;
            return { xOpt: xOpt.toFixed(2), yOpt: yOpt.toFixed(2), esMaxim };
        }, [funcA, funcB, funcC]);
        
        const finances = useMemo(() => {
            const r = taxa / 100;
            // Inter√®s compost
            const VF_simple = capital * (1 + r * anys);
            const VF_compost = capital * Math.pow(1 + r, anys);
            const VF_continu = capital * Math.exp(r * anys);
            // Anualitats
            const VF_anualitat = anualitat * ((Math.pow(1 + r, anys) - 1) / r);
            const VA_anualitat = anualitat * ((1 - Math.pow(1 + r, -anys)) / r);
            // Valor actual
            const VA = capital / Math.pow(1 + r, anys);
            
            return {
                VF_simple: VF_simple.toFixed(2),
                VF_compost: VF_compost.toFixed(2),
                VF_continu: VF_continu.toFixed(2),
                VF_anualitat: VF_anualitat.toFixed(2),
                VA_anualitat: VA_anualitat.toFixed(2),
                VA: VA.toFixed(2)
            };
        }, [capital, taxa, anys, anualitat]);
        
        const excedents = useMemo(() => {
            // Demanda: P = a - bQ => Q = (a-P)/b
            // A preu equilibri pEq:
            const qEq = (pA - pEq) / pB;
            // Excedent consumidor = √†rea triangle = 0.5 * base * altura
            const EC = 0.5 * qEq * (pA - pEq);
            return { qEq: qEq.toFixed(2), EC: EC.toFixed(2) };
        }, [pA, pB, pEq]);
        
        const dadesFunc = useMemo(() => {
            const d = [];
            const xOpt = -funcB / (2 * funcA);
            const start = xOpt - 30;
            const end = xOpt + 30;
            for (let x = start; x <= end; x += 2) {
                d.push({ x: x.toFixed(0), y: funcA * x * x + funcB * x + funcC });
            }
            return d;
        }, [funcA, funcB, funcC]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Matem√†tiques Econ√≤miques' : idioma === 'es' ? 'Matem√°ticas Econ√≥micas' : 'Economic Mathematics'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'derivades', label: idioma === 'val' ? 'üìà Derivades i Optimitzaci√≥' : 'üìà Derivatives & Optimization' },
                    { id: 'integrals', label: idioma === 'val' ? '‚à´ Integrals i Excedents' : '‚à´ Integrals & Surplus' },
                    { id: 'financeres', label: idioma === 'val' ? 'üí∞ Matem√†tiques Financeres' : 'üí∞ Financial Math' },
                    { id: 'matrius', label: idioma === 'val' ? 'üìê Matrius i Sistemes' : 'üìê Matrices & Systems' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'derivades' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìà Optimitzaci√≥ amb Derivades" : "üìà Optimization with Derivatives"} icon="üìà">
                            <div className="grid lg:grid-cols-2 gap-6">
                                <div>
                                    <p className="text-gray-700 mb-4">{idioma === 'val' ? "Funci√≥ quadr√†tica: f(x) = ax¬≤ + bx + c" : "Quadratic function: f(x) = ax¬≤ + bx + c"}</p>
                                    
                                    <div className="space-y-3">
                                        <Slider label="a" value={funcA} onChange={setFuncA} min={-5} max={5} step={0.5} />
                                        <Slider label="b" value={funcB} onChange={setFuncB} min={-200} max={200} step={10} />
                                        <Slider label="c" value={funcC} onChange={setFuncC} min={-500} max={500} step={50} />
                                    </div>
                                    
                                    <ConceptBox title={idioma === 'val' ? "Condici√≥ de Primer Ordre (CPO)" : "First Order Condition (FOC)"} color="blue">
                                        <FormulaBox formula="f'(x) = 2ax + b = 0" />
                                        <FormulaBox formula="x* = -b / (2a)" />
                                    </ConceptBox>
                                    
                                    <ConceptBox title={idioma === 'val' ? "Condici√≥ de Segon Ordre (CSO)" : "Second Order Condition (SOC)"} color="green">
                                        <FormulaBox formula="f''(x) = 2a" />
                                        <p className="text-sm">{idioma === 'val' ? "Si a < 0 ‚Üí M√†xim. Si a > 0 ‚Üí M√≠nim" : "If a < 0 ‚Üí Maximum. If a > 0 ‚Üí Minimum"}</p>
                                    </ConceptBox>
                                </div>
                                <div>
                                    <div className="h-64 mb-4">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <LineChart data={dadesFunc}>
                                                <CartesianGrid strokeDasharray="3 3" />
                                                <XAxis dataKey="x" />
                                                <YAxis />
                                                <Tooltip />
                                                <Line type="monotone" dataKey="y" stroke="#ec4899" strokeWidth={2} dot={false} />
                                                <ReferenceLine x={optimitzacio.xOpt} stroke="#10b981" strokeDasharray="5 5" />
                                            </LineChart>
                                        </ResponsiveContainer>
                                    </div>
                                    <div className={`p-4 rounded-xl text-center ${optimitzacio.esMaxim ? 'bg-green-100' : 'bg-blue-100'}`}>
                                        <p className="text-sm text-gray-600">{optimitzacio.esMaxim ? (idioma === 'val' ? 'M√ÄXIM' : 'MAXIMUM') : (idioma === 'val' ? 'M√çNIM' : 'MINIMUM')}</p>
                                        <p className="text-2xl font-black">x* = {optimitzacio.xOpt}</p>
                                        <p className="text-lg">f(x*) = {optimitzacio.yOpt}</p>
                                    </div>
                                </div>
                            </div>
                        </Card>
                        
                        <Card title={idioma === 'val' ? "üìö Regles de Derivaci√≥" : "üìö Differentiation Rules"} icon="üìö">
                            <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-3">
                                <div className="p-3 bg-blue-50 rounded-lg text-center">
                                    <p className="font-mono text-sm">d/dx [x‚Åø] = nx‚Åø‚Åª¬π</p>
                                    <p className="text-xs text-blue-600">{idioma === 'val' ? 'Pot√®ncia' : 'Power'}</p>
                                </div>
                                <div className="p-3 bg-green-50 rounded-lg text-center">
                                    <p className="font-mono text-sm">d/dx [eÀ£] = eÀ£</p>
                                    <p className="text-xs text-green-600">{idioma === 'val' ? 'Exponencial' : 'Exponential'}</p>
                                </div>
                                <div className="p-3 bg-amber-50 rounded-lg text-center">
                                    <p className="font-mono text-sm">d/dx [ln x] = 1/x</p>
                                    <p className="text-xs text-amber-600">{idioma === 'val' ? 'Logaritme' : 'Logarithm'}</p>
                                </div>
                                <div className="p-3 bg-pink-50 rounded-lg text-center">
                                    <p className="font-mono text-sm">(f¬∑g)' = f'g + fg'</p>
                                    <p className="text-xs text-pink-600">{idioma === 'val' ? 'Producte' : 'Product'}</p>
                                </div>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'integrals' && (
                    <Card title={idioma === 'val' ? "‚à´ Integrals i Excedent del Consumidor" : "‚à´ Integrals and Consumer Surplus"} icon="‚à´">
                        <div className="grid lg:grid-cols-2 gap-6">
                            <div>
                                <p className="text-gray-700 mb-4">{idioma === 'val' ? "Demanda lineal: P = a - bQ" : "Linear demand: P = a - bQ"}</p>
                                
                                <div className="space-y-3">
                                    <Slider label="a (intercepci√≥)" value={pA} onChange={setPA} min={20} max={100} />
                                    <Slider label="b (pendent)" value={pB} onChange={setPB} min={0.5} max={3} step={0.1} />
                                    <Slider label={idioma === 'val' ? "Preu equilibri" : "Equilibrium price"} value={pEq} onChange={setPEq} min={5} max={pA - 5} />
                                </div>
                                
                                <ConceptBox title={idioma === 'val' ? "Excedent del Consumidor" : "Consumer Surplus"} color="green">
                                    <FormulaBox formula="EC = ‚à´‚ÇÄ^Q* (D(Q) - P*) dQ" />
                                    <p className="text-sm">{idioma === 'val' ? "√Ärea entre la corba de demanda i el preu d'equilibri" : "Area between demand curve and equilibrium price"}</p>
                                </ConceptBox>
                            </div>
                            <div>
                                <div className="grid grid-cols-2 gap-3">
                                    <ResultCard title={idioma === 'val' ? "Quantitat Eq." : "Eq. Quantity"} value={excedents.qEq} color="blue" />
                                    <ResultCard title={idioma === 'val' ? "Excedent Cons." : "Consumer Surplus"} value={excedents.EC + "‚Ç¨"} color="green" />
                                </div>
                                
                                <ConceptBox title={idioma === 'val' ? "Aplicacions en Economia" : "Economic Applications"} color="blue">
                                    <ul className="space-y-1 text-sm">
                                        <li>‚Ä¢ {idioma === 'val' ? "Excedent consumidor/productor" : "Consumer/producer surplus"}</li>
                                        <li>‚Ä¢ {idioma === 'val' ? "P√®rdua d'efici√®ncia (DWL)" : "Deadweight loss (DWL)"}</li>
                                        <li>‚Ä¢ {idioma === 'val' ? "Valor present de fluxos continus" : "Present value of continuous flows"}</li>
                                        <li>‚Ä¢ {idioma === 'val' ? "Probabilitats acumulades" : "Cumulative probabilities"}</li>
                                    </ul>
                                </ConceptBox>
                            </div>
                        </div>
                    </Card>
                )}
                
                {tab === 'financeres' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üí∞ Inter√®s Compost i Valor del Diner" : "üí∞ Compound Interest and Time Value"} icon="üí∞">
                            <div className="grid lg:grid-cols-2 gap-6">
                                <div className="space-y-3">
                                    <Slider label={idioma === 'val' ? "Capital Inicial (C‚ÇÄ)" : "Initial Capital (C‚ÇÄ)"} value={capital} onChange={setCapital} min={1000} max={100000} step={1000} suffix="‚Ç¨" />
                                    <Slider label={idioma === 'val' ? "Taxa d'Inter√®s (r)" : "Interest Rate (r)"} value={taxa} onChange={setTaxa} min={1} max={20} step={0.5} suffix="%" />
                                    <Slider label={idioma === 'val' ? "Anys (t)" : "Years (t)"} value={anys} onChange={setAnys} min={1} max={30} />
                                    <Slider label={idioma === 'val' ? "Anualitat (A)" : "Annuity (A)"} value={anualitat} onChange={setAnualitat} min={100} max={10000} step={100} suffix="‚Ç¨" />
                                </div>
                                <div className="space-y-3">
                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="p-3 bg-blue-50 rounded-xl text-center">
                                            <p className="text-xs text-blue-600">{idioma === 'val' ? 'VF Simple' : 'FV Simple'}</p>
                                            <p className="font-bold text-blue-700">{parseInt(finances.VF_simple).toLocaleString()}‚Ç¨</p>
                                            <p className="text-xs text-blue-500">C(1+rt)</p>
                                        </div>
                                        <div className="p-3 bg-green-50 rounded-xl text-center">
                                            <p className="text-xs text-green-600">{idioma === 'val' ? 'VF Compost' : 'FV Compound'}</p>
                                            <p className="font-bold text-green-700">{parseInt(finances.VF_compost).toLocaleString()}‚Ç¨</p>
                                            <p className="text-xs text-green-500">C(1+r)·µó</p>
                                        </div>
                                        <div className="p-3 bg-violet-50 rounded-xl text-center">
                                            <p className="text-xs text-violet-600">{idioma === 'val' ? 'VF Continu' : 'FV Continuous'}</p>
                                            <p className="font-bold text-violet-700">{parseInt(finances.VF_continu).toLocaleString()}‚Ç¨</p>
                                            <p className="text-xs text-violet-500">Ce^(rt)</p>
                                        </div>
                                        <div className="p-3 bg-amber-50 rounded-xl text-center">
                                            <p className="text-xs text-amber-600">{idioma === 'val' ? 'VA Capital' : 'PV Capital'}</p>
                                            <p className="font-bold text-amber-700">{parseInt(finances.VA).toLocaleString()}‚Ç¨</p>
                                            <p className="text-xs text-amber-500">C/(1+r)·µó</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </Card>
                        
                        <Card title={idioma === 'val' ? "üìÖ Anualitats (Rendes)" : "üìÖ Annuities"} icon="üìÖ">
                            <div className="grid md:grid-cols-2 gap-4">
                                <ConceptBox title={idioma === 'val' ? "Valor Futur Anualitat" : "Future Value Annuity"} color="green">
                                    <FormulaBox formula="VF = A ¬∑ [(1+r)‚Åø - 1] / r" />
                                    <p className="text-center text-xl font-bold text-green-700">{parseInt(finances.VF_anualitat).toLocaleString()}‚Ç¨</p>
                                </ConceptBox>
                                <ConceptBox title={idioma === 'val' ? "Valor Actual Anualitat" : "Present Value Annuity"} color="blue">
                                    <FormulaBox formula="VA = A ¬∑ [1 - (1+r)‚Åª‚Åø] / r" />
                                    <p className="text-center text-xl font-bold text-blue-700">{parseInt(finances.VA_anualitat).toLocaleString()}‚Ç¨</p>
                                </ConceptBox>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'matrius' && (
                    <Card title={idioma === 'val' ? "üìê √Älgebra Matricial" : "üìê Matrix Algebra"} icon="üìê">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <ConceptBox title={idioma === 'val' ? "Sistemes d'Equacions" : "Systems of Equations"} color="blue">
                                    <p className="mb-2">{idioma === 'val' ? "Forma matricial: Ax = b" : "Matrix form: Ax = b"}</p>
                                    <FormulaBox formula="x = A‚Åª¬π ¬∑ b" desc={idioma === 'val' ? "Si A √©s invertible" : "If A is invertible"} />
                                </ConceptBox>
                                
                                <ConceptBox title={idioma === 'val' ? "Model Input-Output (Leontief)" : "Input-Output Model (Leontief)"} color="green">
                                    <FormulaBox formula="x = (I - A)‚Åª¬π ¬∑ d" />
                                    <p className="text-sm">{idioma === 'val' ? "x = producci√≥ total, A = matriu coeficients t√®cnics, d = demanda final" : "x = total output, A = technical coefficients matrix, d = final demand"}</p>
                                </ConceptBox>
                            </div>
                            <div>
                                <h4 className="font-bold text-gray-800 mb-3">{idioma === 'val' ? "Operacions B√†siques" : "Basic Operations"}</h4>
                                <div className="space-y-2 text-sm">
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>{idioma === 'val' ? 'Suma:' : 'Addition:'}</strong> (A + B)·µ¢‚±º = A·µ¢‚±º + B·µ¢‚±º
                                    </div>
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>{idioma === 'val' ? 'Producte:' : 'Product:'}</strong> (AB)·µ¢‚±º = Œ£‚Çñ A·µ¢‚Çñ ¬∑ B‚Çñ‚±º
                                    </div>
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>{idioma === 'val' ? 'Determinant 2x2:' : 'Determinant 2x2:'}</strong> |A| = ad - bc
                                    </div>
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>{idioma === 'val' ? 'Inversa 2x2:' : 'Inverse 2x2:'}</strong> A‚Åª¬π = (1/|A|) ¬∑ [d, -b; -c, a]
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // SECTION: ECONOMETRIA
    // ========================================================================
    const Econometria = () => {
        const [tab, setTab] = useState('ols');
        
        // Dades per regressi√≥
        const [xData, setXData] = useState("1, 2, 3, 4, 5, 6, 7, 8, 9, 10");
        const [yData, setYData] = useState("2.1, 4.3, 5.8, 8.2, 9.5, 12.1, 14.3, 15.9, 18.2, 20.1");
        
        const regressio = useMemo(() => {
            const xs = xData.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
            const ys = yData.split(',').map(y => parseFloat(y.trim())).filter(y => !isNaN(y));
            
            if (xs.length < 3 || xs.length !== ys.length) return null;
            
            const n = xs.length;
            const sumX = xs.reduce((a, b) => a + b, 0);
            const sumY = ys.reduce((a, b) => a + b, 0);
            const sumXY = xs.reduce((acc, x, i) => acc + x * ys[i], 0);
            const sumX2 = xs.reduce((acc, x) => acc + x * x, 0);
            const sumY2 = ys.reduce((acc, y) => acc + y * y, 0);
            
            const meanX = sumX / n;
            const meanY = sumY / n;
            
            // Coeficients OLS
            const beta1 = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            const beta0 = meanY - beta1 * meanX;
            
            // Prediccions i residus
            const yHat = xs.map(x => beta0 + beta1 * x);
            const residus = ys.map((y, i) => y - yHat[i]);
            
            // SST, SSE, SSR
            const SST = ys.reduce((acc, y) => acc + Math.pow(y - meanY, 2), 0);
            const SSE = residus.reduce((acc, e) => acc + e * e, 0);
            const SSR = SST - SSE;
            
            // R¬≤
            const R2 = SSR / SST;
            const R2_adj = 1 - ((1 - R2) * (n - 1) / (n - 2));
            
            // Error est√†ndard de la regressi√≥
            const s = Math.sqrt(SSE / (n - 2));
            
            // Error est√†ndard de beta1
            const seBeta1 = s / Math.sqrt(xs.reduce((acc, x) => acc + Math.pow(x - meanX, 2), 0));
            
            // t-estad√≠stic
            const tStat = beta1 / seBeta1;
            
            // F-estad√≠stic
            const F = (SSR / 1) / (SSE / (n - 2));
            
            // Dades per gr√†fic
            const dadesGrafic = xs.map((x, i) => ({ x, y: ys[i], yHat: yHat[i] }));
            
            // Correlaci√≥
            const r = (n * sumXY - sumX * sumY) / Math.sqrt((n * sumX2 - sumX * sumX) * (n * sumY2 - sumY * sumY));
            
            return {
                n,
                beta0: beta0.toFixed(4),
                beta1: beta1.toFixed(4),
                R2: (R2 * 100).toFixed(2),
                R2_adj: (R2_adj * 100).toFixed(2),
                s: s.toFixed(4),
                seBeta1: seBeta1.toFixed(4),
                tStat: tStat.toFixed(3),
                F: F.toFixed(3),
                SST: SST.toFixed(2),
                SSE: SSE.toFixed(2),
                SSR: SSR.toFixed(2),
                r: r.toFixed(4),
                dadesGrafic
            };
        }, [xData, yData]);
        
        return (
            <div className="space-y-6">
                <div><h1 className="text-3xl font-black text-gray-800">{idioma === 'val' ? 'Econometria' : idioma === 'es' ? 'Econometr√≠a' : 'Econometrics'}</h1></div>
                
                <Tabs tabs={[
                    { id: 'ols', label: idioma === 'val' ? 'üìà Regressi√≥ OLS' : 'üìà OLS Regression' },
                    { id: 'hipotesi', label: idioma === 'val' ? 'üî¨ Hip√≤tesis i Diagnosis' : 'üî¨ Hypothesis & Diagnostics' },
                    { id: 'multiple', label: idioma === 'val' ? 'üìä Regressi√≥ M√∫ltiple' : 'üìä Multiple Regression' },
                ]} active={tab} onChange={setTab} />
                
                {tab === 'ols' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üìà Regressi√≥ Lineal Simple (OLS)" : "üìà Simple Linear Regression (OLS)"} icon="üìà">
                            <div className="grid lg:grid-cols-2 gap-6">
                                <div>
                                    <div className="space-y-3 mb-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">X ({idioma === 'val' ? 'variable independent' : 'independent variable'}):</label>
                                            <input type="text" value={xData} onChange={e => setXData(e.target.value)} className="w-full p-2 border rounded-lg text-sm" />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Y ({idioma === 'val' ? 'variable dependent' : 'dependent variable'}):</label>
                                            <input type="text" value={yData} onChange={e => setYData(e.target.value)} className="w-full p-2 border rounded-lg text-sm" />
                                        </div>
                                    </div>
                                    
                                    <FormulaBox formula="Y = Œ≤‚ÇÄ + Œ≤‚ÇÅX + Œµ" desc={idioma === 'val' ? "Model poblacional" : "Population model"} />
                                    
                                    <ConceptBox title={idioma === 'val' ? "Estimadors OLS" : "OLS Estimators"} color="blue">
                                        <FormulaBox formula="Œ≤ÃÇ‚ÇÅ = Œ£(x·µ¢-xÃÑ)(y·µ¢-»≥) / Œ£(x·µ¢-xÃÑ)¬≤" />
                                        <FormulaBox formula="Œ≤ÃÇ‚ÇÄ = »≥ - Œ≤ÃÇ‚ÇÅxÃÑ" />
                                    </ConceptBox>
                                </div>
                                
                                <div>
                                    {regressio && (
                                        <>
                                            <div className="h-48 mb-4">
                                                <ResponsiveContainer width="100%" height="100%">
                                                    <ComposedChart data={regressio.dadesGrafic}>
                                                        <CartesianGrid strokeDasharray="3 3" />
                                                        <XAxis dataKey="x" />
                                                        <YAxis />
                                                        <Tooltip />
                                                        <Scatter dataKey="y" fill="#ec4899" name={idioma === 'val' ? "Observat" : "Observed"} />
                                                        <Line type="monotone" dataKey="yHat" stroke="#3b82f6" strokeWidth={2} dot={false} name={idioma === 'val' ? "Ajustat" : "Fitted"} />
                                                    </ComposedChart>
                                                </ResponsiveContainer>
                                            </div>
                                            
                                            <div className="p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl text-white text-center mb-4">
                                                <p className="text-white/70">{idioma === 'val' ? "Equaci√≥ Estimada" : "Estimated Equation"}</p>
                                                <p className="text-xl font-mono font-bold">≈∂ = {regressio.beta0} + {regressio.beta1}X</p>
                                            </div>
                                            
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                                                <ResultCard title="n" value={regressio.n} color="gray" />
                                                <ResultCard title="R¬≤" value={regressio.R2 + "%"} color="green" />
                                                <ResultCard title="R¬≤ adj" value={regressio.R2_adj + "%"} color="green" />
                                                <ResultCard title="r (corr)" value={regressio.r} color="blue" />
                                            </div>
                                        </>
                                    )}
                                </div>
                            </div>
                        </Card>
                        
                        {regressio && (
                            <Card title={idioma === 'val' ? "üìä Taula ANOVA" : "üìä ANOVA Table"} icon="üìä">
                                <div className="overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead>
                                            <tr className="bg-gray-100">
                                                <th className="p-2 text-left">{idioma === 'val' ? 'Font' : 'Source'}</th>
                                                <th className="p-2 text-right">SS</th>
                                                <th className="p-2 text-right">df</th>
                                                <th className="p-2 text-right">MS</th>
                                                <th className="p-2 text-right">F</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr className="border-b">
                                                <td className="p-2">{idioma === 'val' ? 'Regressi√≥ (SSR)' : 'Regression (SSR)'}</td>
                                                <td className="p-2 text-right">{regressio.SSR}</td>
                                                <td className="p-2 text-right">1</td>
                                                <td className="p-2 text-right">{regressio.SSR}</td>
                                                <td className="p-2 text-right font-bold text-blue-600">{regressio.F}</td>
                                            </tr>
                                            <tr className="border-b">
                                                <td className="p-2">{idioma === 'val' ? 'Residual (SSE)' : 'Residual (SSE)'}</td>
                                                <td className="p-2 text-right">{regressio.SSE}</td>
                                                <td className="p-2 text-right">{regressio.n - 2}</td>
                                                <td className="p-2 text-right">{(parseFloat(regressio.SSE) / (regressio.n - 2)).toFixed(2)}</td>
                                                <td className="p-2 text-right">-</td>
                                            </tr>
                                            <tr className="bg-gray-50 font-bold">
                                                <td className="p-2">Total (SST)</td>
                                                <td className="p-2 text-right">{regressio.SST}</td>
                                                <td className="p-2 text-right">{regressio.n - 1}</td>
                                                <td className="p-2 text-right">-</td>
                                                <td className="p-2 text-right">-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <p className="text-sm text-gray-600 mt-3">
                                    <strong>R¬≤ = SSR/SST = {regressio.R2}%</strong> ({idioma === 'val' ? "variabilitat explicada pel model" : "variability explained by the model"})
                                </p>
                            </Card>
                        )}
                    </div>
                )}
                
                {tab === 'hipotesi' && (
                    <div className="space-y-6">
                        <Card title={idioma === 'val' ? "üî¨ Contrast d'Hip√≤tesis en Regressi√≥" : "üî¨ Hypothesis Testing in Regression"} icon="üî¨">
                            {regressio && (
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <ConceptBox title={idioma === 'val' ? "Test t per Œ≤‚ÇÅ" : "t-test for Œ≤‚ÇÅ"} color="blue">
                                            <p><strong>H‚ÇÄ:</strong> Œ≤‚ÇÅ = 0 ({idioma === 'val' ? "X no afecta Y" : "X doesn't affect Y"})</p>
                                            <p><strong>H‚ÇÅ:</strong> Œ≤‚ÇÅ ‚â† 0</p>
                                            <FormulaBox formula="t = Œ≤ÃÇ‚ÇÅ / SE(Œ≤ÃÇ‚ÇÅ)" />
                                            <div className="grid grid-cols-2 gap-2 mt-3">
                                                <div className="p-2 bg-white rounded text-center">
                                                    <p className="text-xs text-gray-500">SE(Œ≤ÃÇ‚ÇÅ)</p>
                                                    <p className="font-bold">{regressio.seBeta1}</p>
                                                </div>
                                                <div className="p-2 bg-white rounded text-center">
                                                    <p className="text-xs text-gray-500">t-stat</p>
                                                    <p className="font-bold text-blue-600">{regressio.tStat}</p>
                                                </div>
                                            </div>
                                            <p className="text-sm mt-2">
                                                {Math.abs(parseFloat(regressio.tStat)) > 2 
                                                    ? '‚úÖ ' + (idioma === 'val' ? 'Significatiu al 5%' : 'Significant at 5%')
                                                    : '‚ö†Ô∏è ' + (idioma === 'val' ? 'No significatiu' : 'Not significant')}
                                            </p>
                                        </ConceptBox>
                                    </div>
                                    <div>
                                        <ConceptBox title={idioma === 'val' ? "Test F Global" : "Global F-test"} color="green">
                                            <p><strong>H‚ÇÄ:</strong> {idioma === 'val' ? "Tots els Œ≤ = 0" : "All Œ≤ = 0"}</p>
                                            <FormulaBox formula="F = (SSR/k) / (SSE/(n-k-1))" />
                                            <div className="p-3 bg-white rounded text-center mt-3">
                                                <p className="text-xs text-gray-500">F-stat</p>
                                                <p className="text-2xl font-bold text-green-600">{regressio.F}</p>
                                            </div>
                                        </ConceptBox>
                                    </div>
                                </div>
                            )}
                        </Card>
                        
                        <Card title={idioma === 'val' ? "‚ö†Ô∏è Sup√≤sits i Problemes OLS" : "‚ö†Ô∏è OLS Assumptions & Problems"} icon="‚ö†Ô∏è">
                            <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                                <div className="p-4 bg-red-50 rounded-xl">
                                    <h4 className="font-bold text-red-700 mb-2">{idioma === 'val' ? "Heterocedasticitat" : "Heteroskedasticity"}</h4>
                                    <p className="text-sm text-red-600">{idioma === 'val' ? "Vari√†ncia errors no constant. Test: White, Breusch-Pagan" : "Non-constant error variance. Test: White, Breusch-Pagan"}</p>
                                </div>
                                <div className="p-4 bg-amber-50 rounded-xl">
                                    <h4 className="font-bold text-amber-700 mb-2">{idioma === 'val' ? "Autocorrelaci√≥" : "Autocorrelation"}</h4>
                                    <p className="text-sm text-amber-600">{idioma === 'val' ? "Errors correlacionats (s√®ries temporals). Test: Durbin-Watson" : "Correlated errors (time series). Test: Durbin-Watson"}</p>
                                </div>
                                <div className="p-4 bg-blue-50 rounded-xl">
                                    <h4 className="font-bold text-blue-700 mb-2">{idioma === 'val' ? "Multicolinealitat" : "Multicollinearity"}</h4>
                                    <p className="text-sm text-blue-600">{idioma === 'val' ? "Variables X correlacionades. Test: VIF > 10" : "Correlated X variables. Test: VIF > 10"}</p>
                                </div>
                                <div className="p-4 bg-violet-50 rounded-xl">
                                    <h4 className="font-bold text-violet-700 mb-2">{idioma === 'val' ? "Endogene√Øtat" : "Endogeneity"}</h4>
                                    <p className="text-sm text-violet-600">{idioma === 'val' ? "X correlacionat amb Œµ. Soluci√≥: Variables Instrumentals" : "X correlated with Œµ. Solution: Instrumental Variables"}</p>
                                </div>
                            </div>
                            
                            <div className="mt-6 p-4 bg-green-50 rounded-xl">
                                <h4 className="font-bold text-green-700 mb-2">{idioma === 'val' ? "Teorema Gauss-Markov" : "Gauss-Markov Theorem"}</h4>
                                <p className="text-sm text-green-600">{idioma === 'val' ? "Sota els sup√≤sits cl√†ssics, OLS √©s BLUE: Best Linear Unbiased Estimator (m√≠nim vari√†ncia entre estimadors lineals no esbiaixats)." : "Under classical assumptions, OLS is BLUE: Best Linear Unbiased Estimator (minimum variance among linear unbiased estimators)."}</p>
                            </div>
                        </Card>
                    </div>
                )}
                
                {tab === 'multiple' && (
                    <Card title={idioma === 'val' ? "üìä Regressi√≥ M√∫ltiple" : "üìä Multiple Regression"} icon="üìä">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <FormulaBox formula="Y = Œ≤‚ÇÄ + Œ≤‚ÇÅX‚ÇÅ + Œ≤‚ÇÇX‚ÇÇ + ... + Œ≤‚ÇñX‚Çñ + Œµ" desc={idioma === 'val' ? "Model amb k variables" : "Model with k variables"} />
                                
                                <ConceptBox title={idioma === 'val' ? "Interpretaci√≥ Coeficients" : "Coefficient Interpretation"} color="blue">
                                    <p className="text-sm">{idioma === 'val' ? "Œ≤‚±º = canvi en E[Y] quan X‚±º augmenta 1 unitat, mantenint les altres variables constants (ceteris paribus)." : "Œ≤‚±º = change in E[Y] when X‚±º increases by 1 unit, holding other variables constant (ceteris paribus)."}</p>
                                </ConceptBox>
                                
                                <ConceptBox title={idioma === 'val' ? "R¬≤ Ajustat" : "Adjusted R¬≤"} color="green">
                                    <FormulaBox formula="R¬≤‚Çêdj = 1 - [(1-R¬≤)(n-1)/(n-k-1)]" />
                                    <p className="text-sm">{idioma === 'val' ? "Penalitza per afegir variables. Usar per comparar models." : "Penalizes for adding variables. Use to compare models."}</p>
                                </ConceptBox>
                            </div>
                            <div>
                                <h4 className="font-bold text-gray-800 mb-3">{idioma === 'val' ? "Variables Dummy" : "Dummy Variables"}</h4>
                                <div className="bg-amber-50 p-4 rounded-xl mb-4">
                                    <p className="text-sm text-amber-700">{idioma === 'val' ? "Per incloure variables categ√≤riques (g√®nere, regi√≥, etc.)" : "To include categorical variables (gender, region, etc.)"}</p>
                                    <p className="text-sm mt-2"><strong>{idioma === 'val' ? "Regla:" : "Rule:"}</strong> k-1 dummies {idioma === 'val' ? "per k categories (evitar trampa dummy)" : "for k categories (avoid dummy trap)"}</p>
                                </div>
                                
                                <h4 className="font-bold text-gray-800 mb-3">{idioma === 'val' ? "Formes Funcionals" : "Functional Forms"}</h4>
                                <div className="space-y-2 text-sm">
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>Log-Lin:</strong> ln(Y) = Œ≤‚ÇÄ + Œ≤‚ÇÅX ‚Üí Œ≤‚ÇÅ ‚âà % {idioma === 'val' ? "canvi en Y" : "change in Y"}
                                    </div>
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>Lin-Log:</strong> Y = Œ≤‚ÇÄ + Œ≤‚ÇÅln(X) ‚Üí Œ≤‚ÇÅ/100 = {idioma === 'val' ? "canvi en Y per 1%" : "change in Y per 1%"} ‚ÜëX
                                    </div>
                                    <div className="p-2 bg-gray-100 rounded">
                                        <strong>Log-Log:</strong> ln(Y) = Œ≤‚ÇÄ + Œ≤‚ÇÅln(X) ‚Üí Œ≤‚ÇÅ = {idioma === 'val' ? "elasticitat" : "elasticity"}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Card>
                )}
            </div>
        );
    };

    // ========================================================================
    // MAIN RENDER (UPDATED with new sections)
    // ========================================================================
    
    return (
        <div className="min-h-screen">
            {/* Header */}
            <header className="sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-gray-100 shadow-sm">
                <div className="max-w-7xl mx-auto px-4">
                    <div className="flex items-center justify-between h-16">
                        <button onClick={() => setSection('inicio')} className="flex items-center gap-2">
                            <div className="p-2 bg-pink-500 rounded-xl text-white"><Icon name="BarChart3" size={20} /></div>
                            <span className="font-bold text-lg text-gray-800 hidden sm:block">{idioma === 'val' ? 'Economia' : 'Economics'}</span>
                        </button>
                        
                        <nav className="hidden xl:flex items-center gap-1">
                            <NavBtn sec="inicio" icon="Home" label={idioma === 'val' ? 'Inici' : 'Home'} />
                            <NavBtn sec="consumidor" icon="Users" label={idioma === 'val' ? 'Consumidor' : 'Consumer'} />
                            <NavBtn sec="ofertaDemanda" icon="BarChart3" label="O/D" />
                            <NavBtn sec="costos" icon="Factory" label={idioma === 'val' ? 'Costos' : 'Costs'} />
                            <NavBtn sec="mercats" icon="Building2" label={idioma === 'val' ? 'Mercats' : 'Markets'} />
                            <NavBtn sec="fallades" icon="AlertTriangle" label={idioma === 'val' ? 'Fallades' : 'Failures'} />
                            <NavBtn sec="macro" icon="Globe" label="Macro" />
                            <NavBtn sec="monetaria" icon="Landmark" label={idioma === 'val' ? 'Monet√†ria' : 'Monetary'} />
                            <NavBtn sec="comerc" icon="Truck" label={idioma === 'val' ? 'Comer√ß' : 'Trade'} />
                            <NavBtn sec="estadistica" icon="BarChart3" label={idioma === 'val' ? 'Estad√≠stica' : 'Statistics'} />
                            <NavBtn sec="matematiques" icon="Calculator" label={idioma === 'val' ? 'Mates' : 'Math'} />
                            <NavBtn sec="econometria" icon="TrendingUp" label="Econometria" />
                            <NavBtn sec="jocs" icon="Gamepad2" label={idioma === 'val' ? 'Jocs' : 'Games'} />
                            <NavBtn sec="historia" icon="Clock" label={idioma === 'val' ? 'Hist√≤ria' : 'History'} />
                            <NavBtn sec="quiz" icon="Brain" label="Quiz" />
                        </nav>
                        
                        <div className="flex items-center gap-2">
                            <a href="./index.html" className="p-2 text-gray-600 hover:text-pink-500 hover:bg-pink-50 rounded-lg" title={idioma === 'val' ? 'Tornar' : 'Back'}>
                                <Icon name="Home" size={20} />
                            </a>
                            <div className="flex items-center gap-1 bg-gray-100 rounded-lg p-1">
                                {['val', 'es', 'en'].map(lang => (
                                    <button key={lang} onClick={() => setIdioma(lang)} className={`px-2 py-1 rounded text-xs font-bold ${idioma === lang ? 'bg-pink-500 text-white' : 'text-gray-600 hover:bg-gray-200'}`}>
                                        {lang.toUpperCase()}
                                    </button>
                                ))}
                            </div>
                            <button onClick={() => setMenuOpen(!menuOpen)} className="xl:hidden p-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                                <Icon name={menuOpen ? "X" : "Menu"} size={24} />
                            </button>
                        </div>
                    </div>
                    
                    {menuOpen && (
                        <div className="xl:hidden py-4 border-t border-gray-100">
                            <div className="grid grid-cols-5 gap-2">
                                {[
                                    { sec: 'inicio', icon: 'üè†', label: idioma === 'val' ? 'Inici' : 'Home' },
                                    { sec: 'consumidor', icon: 'üë•', label: idioma === 'val' ? 'Consumidor' : 'Consumer' },
                                    { sec: 'ofertaDemanda', icon: 'üìä', label: 'O/D' },
                                    { sec: 'costos', icon: 'üè≠', label: idioma === 'val' ? 'Costos' : 'Costs' },
                                    { sec: 'mercats', icon: 'üè¢', label: idioma === 'val' ? 'Mercats' : 'Markets' },
                                    { sec: 'fallades', icon: '‚ö†Ô∏è', label: idioma === 'val' ? 'Fallades' : 'Failures' },
                                    { sec: 'macro', icon: 'üåç', label: 'Macro' },
                                    { sec: 'monetaria', icon: 'üèõÔ∏è', label: idioma === 'val' ? 'Monet√†ria' : 'Monetary' },
                                    { sec: 'comerc', icon: 'üöö', label: idioma === 'val' ? 'Comer√ß' : 'Trade' },
                                    { sec: 'estadistica', icon: 'üìà', label: idioma === 'val' ? 'Estad√≠stica' : 'Stats' },
                                    { sec: 'matematiques', icon: 'üßÆ', label: idioma === 'val' ? 'Mates' : 'Math' },
                                    { sec: 'econometria', icon: 'üìâ', label: 'Econometria' },
                                    { sec: 'jocs', icon: 'üéÆ', label: idioma === 'val' ? 'Jocs' : 'Games' },
                                    { sec: 'historia', icon: 'üïê', label: idioma === 'val' ? 'Hist√≤ria' : 'History' },
                                    { sec: 'quiz', icon: 'üß†', label: 'Quiz' },
                                ].map(item => (
                                    <button key={item.sec} onClick={() => { setSection(item.sec); setMenuOpen(false); }} className={`p-3 rounded-lg text-center ${section === item.sec ? 'bg-pink-100 text-pink-700' : 'bg-gray-50 text-gray-600'}`}>
                                        <span className="text-xl block mb-1">{item.icon}</span>
                                        <span className="text-xs font-medium">{item.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            </header>
            
            {/* Main */}
            <main className="max-w-7xl mx-auto px-4 py-8">
                {section === 'inicio' && <InicioUpdated />}
                {section === 'consumidor' && <TeoriaConsumidor />}
                {section === 'ofertaDemanda' && <OfertaDemanda />}
                {section === 'costos' && <CostosProducio />}
                {section === 'mercats' && <EstructuresMercat />}
                {section === 'fallades' && <FalladesMercat />}
                {section === 'macro' && <Macroeconomia />}
                {section === 'monetaria' && <EconomiaMonetaria />}
                {section === 'comerc' && <ComercInternacional />}
                {section === 'estadistica' && <Estadistica />}
                {section === 'matematiques' && <Matematiques />}
                {section === 'econometria' && <Econometria />}
                {section === 'jocs' && <TeoriaJocs />}
                {section === 'historia' && <HistoriaEconomica />}
                {section === 'quiz' && <Quiz />}
            </main>
            
            {/* Footer */}
            <footer className="py-6 text-center text-sm text-gray-400 border-t border-gray-100">
                <p>Economia ¬∑ PDE ¬∑ 2025</p>
            </footer>
        </div>
    );
    
    // Updated Inicio with new sections
    function InicioUpdated() {
        const txt = {
            val: { title: "Economia", subtitle: "Guia Universit√†ria Completa", desc: "Des dels fonaments fins als models avan√ßats" },
            es: { title: "Econom√≠a", subtitle: "Gu√≠a Universitaria Completa", desc: "Desde los fundamentos hasta los modelos avanzados" },
            en: { title: "Economics", subtitle: "Complete University Guide", desc: "From fundamentals to advanced models" }
        }[idioma];
        
        const sections = [
            { id: 'consumidor', name: idioma === 'val' ? 'Teoria Consumidor' : idioma === 'es' ? 'Teor√≠a Consumidor' : 'Consumer Theory', icon: 'üë•', color: 'from-pink-500 to-rose-500', desc: idioma === 'val' ? 'Utilitat, prefer√®ncies, corbes indifer√®ncia' : idioma === 'es' ? 'Utilidad, preferencias, curvas indiferencia' : 'Utility, preferences, indifference curves' },
            { id: 'ofertaDemanda', name: idioma === 'val' ? 'Oferta i Demanda' : idioma === 'es' ? 'Oferta y Demanda' : 'Supply & Demand', icon: 'üìä', color: 'from-blue-500 to-cyan-500', desc: idioma === 'val' ? 'Equilibri, elasticitat, excedents' : idioma === 'es' ? 'Equilibrio, elasticidad, excedentes' : 'Equilibrium, elasticity, surplus' },
            { id: 'costos', name: idioma === 'val' ? 'Costos Producci√≥' : idioma === 'es' ? 'Costes Producci√≥n' : 'Production Costs', icon: 'üè≠', color: 'from-amber-500 to-orange-500', desc: idioma === 'val' ? 'CF, CV, CMe, CMg, economies escala' : idioma === 'es' ? 'CF, CV, CMe, CMg, econom√≠as escala' : 'FC, VC, AC, MC, economies of scale' },
            { id: 'mercats', name: idioma === 'val' ? 'Estructures Mercat' : idioma === 'es' ? 'Estructuras Mercado' : 'Market Structures', icon: 'üè¢', color: 'from-violet-500 to-purple-500', desc: idioma === 'val' ? 'CP, Monopoli, Oligopoli (Cournot, Stackelberg)' : idioma === 'es' ? 'CP, Monopolio, Oligopolio (Cournot, Stackelberg)' : 'PC, Monopoly, Oligopoly (Cournot, Stackelberg)' },
            { id: 'fallades', name: idioma === 'val' ? 'Fallades Mercat' : idioma === 'es' ? 'Fallos Mercado' : 'Market Failures', icon: '‚ö†Ô∏è', color: 'from-red-500 to-rose-500', desc: idioma === 'val' ? 'Externalitats, b√©ns p√∫blics, asimetria' : idioma === 'es' ? 'Externalidades, bienes p√∫blicos, asimetr√≠a' : 'Externalities, public goods, asymmetry' },
            { id: 'macro', name: 'Macroeconomia', icon: 'üåç', color: 'from-emerald-500 to-teal-500', desc: idioma === 'val' ? 'PIB, IS-LM, AD-AS, inflaci√≥, atur' : idioma === 'es' ? 'PIB, IS-LM, AD-AS, inflaci√≥n, desempleo' : 'GDP, IS-LM, AD-AS, inflation, unemployment' },
            { id: 'monetaria', name: idioma === 'val' ? 'Economia Monet√†ria' : idioma === 'es' ? 'Econom√≠a Monetaria' : 'Monetary Economics', icon: 'üèõÔ∏è', color: 'from-indigo-500 to-blue-500', desc: idioma === 'val' ? 'Banc Central, pol√≠tica monet√†ria' : idioma === 'es' ? 'Banco Central, pol√≠tica monetaria' : 'Central Bank, monetary policy' },
            { id: 'comerc', name: idioma === 'val' ? 'Comer√ß Internacional' : idioma === 'es' ? 'Comercio Internacional' : 'International Trade', icon: 'üöö', color: 'from-cyan-500 to-teal-500', desc: idioma === 'val' ? 'Avantatge comparatiu, aranzels' : idioma === 'es' ? 'Ventaja comparativa, aranceles' : 'Comparative advantage, tariffs' },
            { id: 'estadistica', name: idioma === 'val' ? 'Estad√≠stica' : idioma === 'es' ? 'Estad√≠stica' : 'Statistics', icon: 'üìà', color: 'from-sky-500 to-blue-500', desc: idioma === 'val' ? 'Descriptiva, probabilitat, infer√®ncia' : idioma === 'es' ? 'Descriptiva, probabilidad, inferencia' : 'Descriptive, probability, inference' },
            { id: 'matematiques', name: idioma === 'val' ? 'Mates Econ√≤miques' : idioma === 'es' ? 'Mates Econ√≥micas' : 'Economic Math', icon: 'üßÆ', color: 'from-lime-500 to-green-500', desc: idioma === 'val' ? 'Derivades, integrals, mat. financeres' : idioma === 'es' ? 'Derivadas, integrales, mat. financieras' : 'Derivatives, integrals, financial math' },
            { id: 'econometria', name: 'Econometria', icon: 'üìâ', color: 'from-orange-500 to-red-500', desc: idioma === 'val' ? 'Regressi√≥ OLS, R¬≤, hip√≤tesis' : idioma === 'es' ? 'Regresi√≥n OLS, R¬≤, hip√≥tesis' : 'OLS regression, R¬≤, hypothesis' },
            { id: 'jocs', name: idioma === 'val' ? 'Teoria de Jocs' : idioma === 'es' ? 'Teor√≠a de Juegos' : 'Game Theory', icon: 'üéÆ', color: 'from-fuchsia-500 to-pink-500', desc: idioma === 'val' ? 'Nash, dilema presoner' : idioma === 'es' ? 'Nash, dilema prisionero' : 'Nash, prisoner dilemma' },
            { id: 'historia', name: idioma === 'val' ? 'Hist√≤ria Econ√≤mica' : idioma === 'es' ? 'Historia Econ√≥mica' : 'Economic History', icon: 'üïê', color: 'from-gray-500 to-slate-500', desc: idioma === 'val' ? 'Smith, Keynes, Friedman' : 'Smith, Keynes, Friedman' },
        ];
        
        return (
            <div className="space-y-8">
                <div className="text-center py-8">
                    <div className="inline-flex items-center gap-2 px-4 py-2 bg-pink-100 rounded-full text-pink-600 text-sm font-medium mb-4">
                        üéì {idioma === 'val' ? 'Batxillerat ¬∑ FP ¬∑ Universitat' : idioma === 'es' ? 'Bachillerato ¬∑ FP ¬∑ Universidad' : 'High School ¬∑ Vocational ¬∑ University'}
                    </div>
                    <h1 className="text-4xl md:text-5xl font-black text-gray-800 mb-4">{txt.title}</h1>
                    <p className="text-xl text-gray-500 mb-2">{txt.subtitle}</p>
                    <p className="text-gray-400">{txt.desc}</p>
                </div>
                
                <div className="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    {sections.map(sec => (
                        <button key={sec.id} onClick={() => setSection(sec.id)} className="group text-left bg-white rounded-2xl border border-gray-100 overflow-hidden hover:shadow-lg transition-all">
                            <div className={`p-4 bg-gradient-to-r ${sec.color} text-white text-2xl`}>{sec.icon}</div>
                            <div className="p-4">
                                <h3 className="font-bold text-gray-800 group-hover:text-pink-600">{sec.name}</h3>
                                <p className="text-sm text-gray-500 mt-1">{sec.desc}</p>
                            </div>
                        </button>
                    ))}
                </div>
                
                <Card title={idioma === 'val' ? "Qu√® √©s l'Economia?" : idioma === 'es' ? "¬øQu√© es la Econom√≠a?" : "What is Economics?"} icon="üìñ">
                    <div className="grid md:grid-cols-2 gap-6">
                        <div>
                            <p className="text-gray-700 mb-4">
                                {idioma === 'val' ? "L'economia estudia com les societats administren recursos escassos per satisfer necessitats il¬∑limitades." : idioma === 'es' ? "La econom√≠a estudia c√≥mo las sociedades administran recursos escasos para satisfacer necesidades ilimitadas." : "Economics studies how societies manage scarce resources to satisfy unlimited needs."}
                            </p>
                            <ConceptBox title={idioma === 'val' ? "Escassetat" : idioma === 'es' ? "Escasez" : "Scarcity"} color="pink">
                                {idioma === 'val' ? "Recursos limitats, desitjos infinits. Aix√≤ ens obliga a triar." : idioma === 'es' ? "Recursos limitados, deseos infinitos. Esto nos obliga a elegir." : "Limited resources, infinite wants. This forces us to choose."}
                            </ConceptBox>
                            <ConceptBox title={idioma === 'val' ? "Cost d'Oportunitat" : idioma === 'es' ? "Coste de Oportunidad" : "Opportunity Cost"} color="blue">
                                {idioma === 'val' ? "El valor de la millor alternativa sacrificada." : idioma === 'es' ? "El valor de la mejor alternativa sacrificada." : "The value of the best alternative foregone."}
                            </ConceptBox>
                        </div>
                        <div className="grid grid-cols-2 gap-3">
                            <div className="bg-pink-50 p-4 rounded-xl text-center">
                                <p className="text-3xl mb-2">üë•</p>
                                <p className="font-bold text-pink-700">Micro</p>
                                <p className="text-xs text-pink-600">{idioma === 'val' ? 'Individus i empreses' : idioma === 'es' ? 'Individuos y empresas' : 'Individuals & firms'}</p>
                            </div>
                            <div className="bg-blue-50 p-4 rounded-xl text-center">
                                <p className="text-3xl mb-2">üåç</p>
                                <p className="font-bold text-blue-700">Macro</p>
                                <p className="text-xs text-blue-600">{idioma === 'val' ? 'Economia agregada' : idioma === 'es' ? 'Econom√≠a agregada' : 'Aggregate economy'}</p>
                            </div>
                            <div className="bg-green-50 p-4 rounded-xl text-center">
                                <p className="text-3xl mb-2">üìà</p>
                                <p className="font-bold text-green-700">{idioma === 'val' ? 'Quanti' : 'Quant'}</p>
                                <p className="text-xs text-green-600">{idioma === 'val' ? 'Estad√≠stica i econometria' : 'Statistics & econometrics'}</p>
                            </div>
                            <div className="bg-amber-50 p-4 rounded-xl text-center">
                                <p className="text-3xl mb-2">üßÆ</p>
                                <p className="font-bold text-amber-700">{idioma === 'val' ? 'Mates' : 'Math'}</p>
                                <p className="text-xs text-amber-600">{idioma === 'val' ? 'Eines matem√†tiques' : 'Mathematical tools'}</p>
                            </div>
                        </div>
                    </div>
                </Card>
            </div>
        );
    }
}

ReactDOM.render(<EconomiaApp />, document.getElementById('root'));
    </script>
</body>
</html>
